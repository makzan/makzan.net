var b2Vec2=Box2D.Common.Math.b2Vec2,b2AABB=Box2D.Collision.b2AABB,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2PrismaticJointDef=Box2D.Dynamics.Joints.b2PrismaticJointDef,b2RevoluteJointDef=
Box2D.Dynamics.Joints.b2RevoluteJointDef,b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef;
(function(c){var a=function(){throw"Ticker cannot be instantiated.";};a.useRAF=null;a._listeners=null;a._pauseable=null;a._paused=false;a._inited=false;a._startTime=0;a._pausedTime=0;a._ticks=0;a._pausedTickers=0;a._interval=50;a._lastTime=0;a._times=null;a._tickTimes=null;a._rafActive=false;a.addListener=function(b,d){a._inited||a.init();a.removeListener(b);a._pauseable[a._listeners.length]=d==null?true:d;a._listeners.push(b)};a.init=function(){a._inited=true;a._times=[];a._tickTimes=[];a._pauseable=
[];a._listeners=[];a._times.push(a._startTime=a._getTime());a.setInterval(a._interval)};a.removeListener=function(b){if(a._listeners!=null){b=a._listeners.indexOf(b);if(b!=-1){a._listeners.splice(b,1);a._pauseable.splice(b,1)}}};a.removeAllListeners=function(){a._listeners=[];a._pauseable=[]};a.setInterval=function(b){a._lastTime=a._getTime();a._interval=b;if(a.useRAF){var d=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame;
if(d){d(a._handleAF);a._rafFunction=d;return}}this._inited&&setTimeout(a._handleTimeout,b)};a.getInterval=function(){return a._interval};a.setFPS=function(b){a.setInterval(1E3/b)};a.getFPS=function(){return 1E3/a._interval};a.getMeasuredFPS=function(b){if(a._times.length<2)return-1;if(b==null)b=a.getFPS()>>1;b=Math.min(a._times.length-1,b);return 1E3/((a._times[0]-a._times[b])/b)};a.setPaused=function(b){a._paused=b};a.getPaused=function(){return a._paused};a.getTime=function(b){return a._getTime()-
a._startTime-(b?a._pausedTime:0)};a.getTicks=function(b){return a._ticks-(b?a._pausedTickers:0)};a._handleAF=function(b){console.log(a._rafFunction);b-a._lastTime>=a._interval-1&&a._tick();(c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame)(a._handleAF,a.animationTarget)};a._handleTimeout=function(){a._tick();setTimeout(a._handleTimeout,a._interval)};a._tick=function(){a._ticks++;var b=a._getTime(),d=b-a._lastTime,
f=a._paused;if(f){a._pausedTickers++;a._pausedTime+=d}a._lastTime=b;for(var i=a._pauseable,g=a._listeners.slice(),j=g?g.length:0,e=0;e<j;e++){var k=i[e],h=g[e];h==null||f&&k||h.tick==null||h.tick(d,f)}for(a._tickTimes.unshift(a._getTime()-b);a._tickTimes.length>100;)a._tickTimes.pop();for(a._times.unshift(b);a._times.length>100;)a._times.pop()};a._getTime=function(){return(new Date).getTime()};c.Ticker=a})(window);
(function(k){Tween=function(a,b){this.initialize(a,b)};var d=Tween.prototype;Tween._tweens=[];Tween.cssSuffixMap={top:"px",left:"px",bottom:"px",right:"px",width:"px",height:"px",opacity:""};Tween.get=function(a,b){return new Tween(a,b)};Tween.tick=function(a,b){for(var c=Tween._tweens,g=c.length-1;g>=0;g--){var e=c[g];b&&!e.ignoreGlobalPause||e.tick(e._useTicks?1:a)}};Ticker&&Ticker.addListener(Tween,false);Tween.removeTweens=function(a){if(a.tweenjs_count){for(var b=Tween._tweens,c=b.length-1;c>=
0;c--)b[c]._target==a&&b.splice(c,1);a.tweenjs_count=0}};Tween._register=function(a,b){var c=a._target;if(b){c.tweenjs_count=c.tweenjs_count?c.tweenjs_count+1:1;Tween._tweens.push(a)}else{c.tweenjs_count--;c=Tween._tweens.indexOf(a);c!=-1&&Tween._tweens.splice(c,1)}};d.ignoreGlobalPause=false;d.loop=false;d.cssSuffixMap=null;d._paused=false;d._curQueueProps=null;d._initQueueProps=null;d._steps=null;d._actions=null;d._prevPosition=0;d._prevPos=-1;d._prevIndex=-1;d._target=null;d._duration=0;d._css=
false;d._useTicks=false;d.initialize=function(a,b){this._target=a;this._useTicks=b.useTicks;this._css=b.css;this.ignoreGlobalPause=b.ignoreGlobalPause;this.loop=b.loop;b.override&&Tween.removeTweens(a);this._curQueueProps={};this._initQueueProps={};this._steps=[];this._actions=[];this._catalog=[];Tween._register(this,true)};d.wait=function(a){if(a==null||a<=0)return this;var b=this._cloneProps(this._curQueueProps);return this._addStep({d:a,p0:b,e:this._linearEase,p1:b})};d.to=function(a,b,c){if(isNaN(b)||
b<0)b=0;return this._addStep({d:b?b:0,p0:this._cloneProps(this._curQueueProps),e:c,p1:this._cloneProps(this._appendQueueProps(a))})};d.call=function(a,b,c){return this._addAction({f:a,p:b?b:[this],o:c?c:this._target})};d.set=function(a,b){return this._addAction({f:this._set,o:this,p:[a,b?b:this._target]})};d.play=function(a){return this.call(a.setPaused,[false],a)};d.pause=function(a){a||(a=this);return this.call(a.setPaused,[true],a)};d.setPosition=function(a,b){if(a!=this._prevPosition){if(b==null)b=
true;var c=a,g=false;if(c>this._duration)if(this.loop){c%=this._duration;g=c<this._prevPos}else c=this._duration;if(c!=this._prevPos)if(c==this._duration&&!this.loop)this._updateTargetProps(null,1);else if(this._steps.length>0){for(var e=0,f=this._steps.length;e<f;e++)if(this._steps[e].t>c)break;e=this._steps[e-1];this._updateTargetProps(e,(c-e.t)/e.d)}if(b&&this._actions.length>0)if(g){this._runActions(this._prevPos,this._duration);this._runActions(0,c)}else this._runActions(this._prevPos,c);this._prevPos=
c;this._prevPosition=a;c==this._duration&&!this.loop&&this.setPaused(true)}};d.tick=function(a){this._paused||this.setPosition(this._prevPosition+a)};d.setPaused=function(a){this._paused=!!a;Tween._register(this,!a)};d.w=d.wait;d.t=d.to;d.p=d.pause;d.pl=d.play;d.c=d.call;d.s=d.set;d.toString=function(){return"[Tween]"};d.clone=function(){throw"Tween is not cloneable.";};d._updateTargetProps=function(a,b){if(this._css)var c=this.cssSuffixMap||Tween.cssSuffixMap;var g,e,f,h;if(!a&&b==1)g=e=this._curQueueProps;
else{if(a.e)b=a.e(b,0,1,1);g=a.p0;e=a.p1}for(n in this._initQueueProps){if((f=g[n])==null)g[n]=f=this._initQueueProps[n];if(f==(h=e[n])||b==0||b==1||typeof f!="number"){if(b==1)f=h}else f+=(h-f)*b;this._target[n]=c&&c[n]?f+c[n]:f}};d._runActions=function(a,b,c){var g=a,e=b,f=-1,h=this._actions.length,j=1;if(a>b){g=b;e=a;f=h;h=j=-1}for(;(f+=j)!=h;){b=this._actions[f];var i=b.t;if(i>g&&i<=e||c&&i==a)b.f.apply(b.o,b.p)}};d._appendQueueProps=function(a){if(this._css)var b=this.cssSuffixMap||Tween.cssSuffixMap;
var c,g,e;for(e in a){if(this._initQueueProps[e]==null)if(b&&(c=b[e])!=null){var f=this._target[e],h=f.length-c.length;if((g=f.substr(h))!=c)throw"TweenJS Error: Suffixes do not match. ("+c+":"+g+")";else this._initQueueProps[e]=parseInt(f.substr(0,h))}else this._initQueueProps[e]=this._target[e];this._curQueueProps[e]=a[e]}return this._curQueueProps};d._cloneProps=function(a){var b={},c;for(c in a)b[c]=a[c];return b};d._addStep=function(a){if(a.d>0){this._steps.push(a);a.t=this._duration;this._duration+=
a.d}return this};d._addAction=function(a){a.t=this._duration;this._actions.push(a);return this};d._set=function(a,b){for(var c in a)b[c]=a[c]};k.Tween=Tween})(window);
soundManager.url="sm2-flash-files/";soundManager.debugMode=false;soundManager.useHTML5Audio=true;soundManager.preferFlash=false;
soundManager.onready(function(){soundManager.createSound({id:"bgm",url:"audio/bgm.m4a"});soundManager.createSound({id:"launchChicken",url:"audio/launching_chicken.m4a"});soundManager.createSound({id:"feverModeBgm",url:"audio/fever_mode_bgm.m4a"});soundManager.createSound({id:"btmDoorOpen",url:"audio/btm_door_open.m4a"});soundManager.createSound({id:"btmDoorClose",url:"audio/btm_door_close.m4a"});soundManager.createSound({id:"clickBtn",url:"audio/button_click.m4a"});soundManager.createSound({id:"chickenLose",
url:"audio/chicken_disappear.m4a"});soundManager.createSound({id:"earnCoin",url:"audio/earning_coins.m4a"});soundManager.createSound({id:"feverModeChickenPassSlot",url:"audio/fever_mode_chicken_pass_slot.m4a"});soundManager.createSound({id:"pinLvUp",url:"audio/nail_lv_up.m4a"});soundManager.createSound({id:"pinLvDown",url:"audio/nail_lv_down.m4a"});soundManager.createSound({id:"noMoreChicken",url:"audio/no_more_chicken.m4a"});soundManager.createSound({id:"passFeverTrigger",url:"audio/pass_alert.m4a"});
soundManager.createSound({id:"prizeGet",url:"audio/prize_get.m4a"});soundManager.createSound({id:"triggerSlotMachine",url:"audio/trigger_slot_machine.m4a"});SoundManagerHelper.loopSound("bgm");GameSave.loadIsBGMOn()?$("#bgmImage").attr("src","images/bgm_on.png"):$("#bgmImage").attr("src","images/bgm_off.png");if(GameSave.loadIsSFXOn()){$("#sfxImage").attr("src","images/sfx_on.png");SoundManagerHelper.unmuteSFX()}else{$("#sfxImage").attr("src","images/sfx_off.png");SoundManagerHelper.muteSFX()}SoundManagerHelper.muteBGM()});
soundManager.ontimeout(function(){});
function SoundManagerHelper(){}SoundManagerHelper.loopSound=function(a){soundManager.getSoundById(a).play({onfinish:function(){SoundManagerHelper.loopSound(a)}})};SoundManagerHelper.playSound=function(a){soundManager.getSoundById(a).play()};SoundManagerHelper.stopSound=function(a){soundManager.getSoundById(a).stop()};SoundManagerHelper.muteBGM=function(){soundManager.getSoundById("bgm").mute();soundManager.getSoundById("feverModeBgm").mute()};
SoundManagerHelper.unmuteBGM=function(){soundManager.getSoundById("bgm").unmute();soundManager.getSoundById("feverModeBgm").unmute();soundManager.getSoundById("bgm").setPosition(0);soundManager.getSoundById("feverModeBgm").setPosition(0)};SoundManagerHelper.muteSFX=function(){soundManager.mute()};SoundManagerHelper.unmuteSFX=function(){soundManager.unmute();soundManager.getSoundById("bgm").mute();soundManager.getSoundById("feverModeBgm").mute()};
var POINTS_PER_METER=64;function PointsToMeters(a){return a/POINTS_PER_METER}function MetersToPoints(a){return a*POINTS_PER_METER}function b2Vec2_px2m(a,d){return new b2Vec2(PointsToMeters(a),PointsToMeters(d))}function createBodyDef(a,d,e){var b=new b2BodyDef;switch(a){case "kinematic":b.type=b2Body.b2_kinematicBody;break;case "dynamic":b.type=b2Body.b2_dynamicBody;break;default:b.type=b2Body.b2_staticBody}b.position=d;if(typeof e=="undefined")e=0;b.angle=e;b.userData={};return b}
function createFixtureDef(a,d,e,b,f,g,h){var c=new b2FixtureDef;c.density=f;c.restitution=g;c.friction=h;if(a=="polygon"){c.shape=new b2PolygonShape;c.shape.SetAsBox(d,e)}if(a=="circle")c.shape=new b2CircleShape(b);return c};
function b2ContactListener(){this.contacts=[]}
b2ContactListener.prototype.b2ContactsChecking=function(a){for(var g=0;g<this.contacts.length;g++){var i=this.contacts[g];if(!i.isProcessed){var e=i.fixtureA.GetBody(),f=i.fixtureB.GetBody(),b=e.GetUserData(),c=f.GetUserData();if(b!=undefined&&c!=undefined){b.type=="coin"&&c.type=="coin"&&a.slots.shouldClearSlotsChecking(e,f,a.tutoCenter);if(b.type=="nail"&&c.type=="coin"||b.type=="coin"&&c.type=="nail"){var h=e,d=f;if(b.type=="coin"){h=f;d=e}a.nails.hitByCoin(h,d,a.slots,a.slotMachine)}if(b.type==
"trigger"&&c.type=="coin"||b.type=="coin"&&c.type=="trigger"){h=e;d=f;if(b.type=="coin"){h=f;d=e}a.triggers.hitByCoin(h,d,a.coins,a.nails,a.slides,a.windmills,a.triggers,a.tutoCenter)}if(b.type=="btmWall"&&c.type=="coin"||b.type=="coin"&&c.type=="btmWall")b.type=="coin"?a.boundingBox.addCoinBodyToRemoveList(e):a.boundingBox.addCoinBodyToRemoveList(f);if(b.type=="mouse"||c.type=="mouse")a.mouse.hitAnyObj(b,c);if(b.type=="coin"||c.type=="coin"){d=b.type=="coin"?e:f;if(b.type=="coin"&&c.type=="mouse"||
b.type=="mouse"&&c.type=="coin")d.GetUserData().graphics.chickEmoMC.isPaused||d.GetUserData().graphics.chickEmoMC.stopAtForTimeAndBackToCurrent(6,60);if(b.type=="coin"&&c.type=="slide"||b.type=="slide"&&c.type=="coin")d.GetUserData().graphics.chickEmoMC.isPaused||d.GetUserData().graphics.chickEmoMC.stopAtForTimeAndBackToCurrent(17,30);if(b.type=="coin"&&c.type=="windmill"||b.type=="windmill"&&c.type=="coin")d.GetUserData().graphics.chickEmoMC.isPaused||d.GetUserData().graphics.chickEmoMC.stopAtForTimeAndBackToCurrent(16,
30)}if(b.type=="btmSensor"&&c.type=="coin"||b.type=="coin"&&c.type=="btmSensor"){c=e;d=f;if(b.type=="coin"){d=e;c=f}a.slots.hitByCoin(c,d,a.slotMachine,a.tutoCenter)}}i.isProcessed=true}}};b2ContactListener.prototype.BeginContact=function(a){this.contacts.push({fixtureA:a.GetFixtureA(),fixtureB:a.GetFixtureB(),isContinuous:a.IsContinuous()})};
b2ContactListener.prototype.EndContact=function(a){a={fixtureA:a.GetFixtureA(),fixtureB:a.GetFixtureB(),isContinuous:a.IsContinuous()};for(var g=0;g<this.contacts.length;g++)a.fixtureA==this.contacts[g].fixtureA&&a.fixtureB==this.contacts[g].fixtureB&&this.contacts.splice(g,1)};b2ContactListener.prototype.PreSolve=function(){};b2ContactListener.prototype.PostSolve=function(){};
function Enum(){}Enum.Sprites={kSpritesSlide:0,kSpritesWindmillLarge:1,kSpritesWindmillSmall:2,kSpritesWindmillTop:3,kSpritesLaunchTunnel:4,kSpritesMouse:5};Enum.AlertMessage={kMsgBonusCoins:0,kMsgBonusXP:1,kMsgGetOneCoin:2,kMsgGetTwoCoins:3,kMsgGetFiveCoins:4,kMsgGet15s:5,kMsgGet30s:6,kMsgGetMultiplierOnePtTwo:7,kMsgGetMultiplierOnePtFive:8,kMsgGetFeverMode:9,kMsgGetOneItem:10,kMsgGetNothing:11};
Enum.SlotMachinePrize={kPrizeAddOneCoin:0,kPrizeAddTwoCoin:1,kPrizeAddFiveCoin:2,kPrizeMultiplierOnePtTwo:3,kPrizeMultiplierOnePtFive:4,kPrizeFeverMode:5,kPrizeGetItems:6,kPrizeGetNothing:7};Enum.ItemClass={kClassCommon:1,kClassUncommon:2,kClassRare:3,kClassSuperRare:4};
Enum.ItemSeries={kSeriesFeverTimeInc:1,kSeriesMultiplierOnePtTwoTimeInc:2,kSeriesMultiplierOnePtFiveTimeInc:3,kSeriesInGameAutoCoinGenTimeDec:4,kSeriesAutoCoinGenLimitInc:5,kSeriesMaxCoinsInMachineInc:6,kSeriesProbToGetPrizeInc:7,kSeriesProbToGetGoodItemInc:8};Enum.TutoNo={kTutoFeverMode:1,kTutoHitFeverTrigger:2,kTutoSpotlight:3,kTutoLoseAllChicken:4,kTutoCanEarn:5,kTutoFailToAddCoin:6,kTutoPinLvUp:7,kTutoXPLvUp:8};Enum.size=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};
var mcLoader,gameVar,timeline,canvas=document.getElementById("game"),canvasWidth=320,canvasHeight=480,SLOT_AMOUNT=8,SLOTWALL_WIDTH=0.04,SLOTWALL_HEIGHT=0.8,SIDEWALL_WIDTH=0.07,NAIL_R_PX=3.5,NAIL_MAX_LV=4,NAIL_AMOUNT=29,NAIL_LV_UP_TIME=90,LOW_UI_SPACE=50,CANVASHEIGHT_DIVISION=20,RELOAD_TIME=30,MAX_COINS_TO_TRIGGER_BET=15,MAX_TRIGGER_SLOT_MACHINE_COUNT=3,TRIGGER_AMOUNT=5,RANDOM_GEN_CON_TRIGGER_NO_TIME=150,MAX_COIN_LIVE_TIME=900,MAX_ITEM_CLASS=4,MAX_ITEM_SERIES=8,MAX_ITEM_COUNT_LIMIT=5,MAX_NAIL_LV_UP_COUNTER=
90,slotWidthPX=(canvasWidth-2*MetersToPoints(SLOTWALL_WIDTH)*(SLOT_AMOUNT-1)-2*MetersToPoints(SIDEWALL_WIDTH))/SLOT_AMOUNT,xPosOfSlots=[];xPosOfSlots.push(0);for(var i=1;i<SLOT_AMOUNT;i++){var slot_xpos=MetersToPoints(SIDEWALL_WIDTH)+slotWidthPX*i+MetersToPoints(SLOTWALL_WIDTH)+2*MetersToPoints(SLOTWALL_WIDTH)*(i-1);xPosOfSlots.push(slot_xpos)}xPosOfSlots.push(canvasWidth);
function Digits(){}Digits.show=function(c,a,e){a=a.toString();for(var d in c){var b=a[a.length-d-1];if(b==undefined)b=0;if(e&&d==c.length-1)b=10;c[d].stopAt(b)}};
function GameSave(){}GameSave.prefix="net.42games.chickenrain.";
GameSave.loadRemainCoins=function(){var a;if(Modernizr.localstorage)if(localStorage[GameSave.prefix+"isFirstTimePlay"]=="true"||localStorage[GameSave.prefix+"isFirstTimePlay"]==undefined){a=15;localStorage[GameSave.prefix+"remainCoins"]=a;Digits.show(mcLoader.score_digits_movieClips,a,false);localStorage[GameSave.prefix+"isFirstTimePlay"]=false;localStorage[GameSave.prefix+"isBGMOn"]=true;localStorage[GameSave.prefix+"isSFXOn"]=true}else{a=parseInt(localStorage[GameSave.prefix+"remainCoins"]);localStorage[GameSave.prefix+
"remainCoins"]=a;Digits.show(mcLoader.score_digits_movieClips,a,false)}return a};GameSave.saveRemainCoins=function(a){if(Modernizr.localstorage){if(gameVar!=undefined)gameVar.isInTimeChallengeMode||(localStorage[GameSave.prefix+"remainCoins"]=a);Digits.show(mcLoader.score_digits_movieClips,a,false)}};
GameSave.loadCollectionsModel=function(){var a={};if(localStorage[GameSave.prefix+"isFirstTimeLoadCollection"]=="true"||localStorage[GameSave.prefix+"isFirstTimeLoadCollection"]==undefined){a.seriesFeverTimeIncItems=[0,0,0,0];a.seriesMultiplierOnePtFiveTimeIncItems=[0,0,0,0];a.seriesMultiplierTwoTimeIncItems=[0,0,0,0];a.seriesInGameAutoCoinGenTimeDecItems=[0,0,0,0];a.seriesAutoCoinGenLimitIncItems=[0,0,0,0];a.seriesMaxCoinsInMachineIncItems=[0,0,0,0];a.seriesProbToGetPrizeIncItems=[0,0,0,0];a.seriesProbToGetGoodItemIncItems=
[0,0,0,0];GameSave.saveCollectionsModel(a);localStorage[GameSave.prefix+"isFirstTimeLoadCollection"]=false}else a=JSON.parse(localStorage[GameSave.prefix+"collectionsModel"]);return a};GameSave.saveCollectionsModel=function(a){localStorage[GameSave.prefix+"collectionsModel"]=JSON.stringify(a)};GameSave.loadIsFirstTimeShowTutoWithKey=function(a){return localStorage[GameSave.prefix+a]=="true"||localStorage[GameSave.prefix+a]==undefined};
GameSave.saveIsFirstTimeShowTutoWithKey=function(a){localStorage[GameSave.prefix+a]=false};GameSave.loadIsBGMOn=function(){return localStorage[GameSave.prefix+"isBGMOn"]=="true"||localStorage[GameSave.prefix+"isBGMOn"]==undefined};GameSave.saveIsBGMOn=function(a){localStorage[GameSave.prefix+"isBGMOn"]=a};GameSave.loadIsSFXOn=function(){return localStorage[GameSave.prefix+"isSFXOn"]=="true"||localStorage[GameSave.prefix+"isSFXOn"]==undefined};
GameSave.saveIsSFXOn=function(a){localStorage[GameSave.prefix+"isSFXOn"]=a};
function MachineParameters(){this.collections=GameSave.loadCollectionsModel()}MachineParameters.prototype.feverModeCountdownTime=function(){return 20+this.levelOfFeverModeCountdownTime()*2};MachineParameters.prototype.levelOfFeverModeCountdownTime=function(){return this.seriesLevel(this.collections.seriesFeverTimeIncItems)};MachineParameters.prototype.multiplierOnePointTwoCountdownTime=function(){return 45+this.levelOfMultiplierOnePointFiveCountdownTime()*4};
MachineParameters.prototype.levelOfMultiplierOnePointFiveCountdownTime=function(){return this.seriesLevel(this.collections.seriesMultiplierOnePtFiveTimeIncItems)};MachineParameters.prototype.multiplierOnePointFiveCountdownTime=function(){return 45+this.levelOfMultiplierTwoCountdownTime()*4};MachineParameters.prototype.levelOfMultiplierTwoCountdownTime=function(){return this.seriesLevel(this.collections.seriesMultiplierTwoTimeIncItems)};
MachineParameters.prototype.autoGenCoinCountdownTime=function(){return 30-this.levelOfAutoGenCoinCountdownTime()*1};MachineParameters.prototype.levelOfAutoGenCoinCountdownTime=function(){return this.seriesLevel(this.collections.seriesInGameAutoCoinGenTimeDecItems)};MachineParameters.prototype.autoGenCoinLimit=function(){return 20+this.levelOfAutoGenCoinLimit()*5};MachineParameters.prototype.levelOfAutoGenCoinLimit=function(){return this.seriesLevel(this.collections.seriesAutoCoinGenLimitIncItems)};
MachineParameters.prototype.coinsInMachineLimit=function(){return 8+this.levelOfCoinsInMachineLimit()*1};MachineParameters.prototype.levelOfCoinsInMachineLimit=function(){return this.seriesLevel(this.collections.seriesMaxCoinsInMachineIncItems)};MachineParameters.prototype.levelOfPrizeProbs=function(){return this.seriesLevel(this.collections.seriesProbToGetPrizeIncItems)};
MachineParameters.prototype.prizeProbsAtPrize=function(d){var a=0;switch(d){case 0:a=20;break;case 1:a=9.5;break;case 2:a=6.5;break;case 3:a=4.5;break;case 4:a=3;break;case 5:a=0.7;break;case 6:prizeProbsLevel=0;break;case 7:a=55.8}return a};MachineParameters.prototype.levelOfItemClassProb=function(){return this.seriesLevel(this.collections.seriesProbToGetGoodItemIncItems)};
MachineParameters.prototype.itemClassProbsAtItemClassNo=function(d,a){var c=0,b=this.levelOfItemClassProb();switch(d){case 0:c=a?5-b*3:75-b*3;break;case 1:c=a?50+b*2.3:18+b*2.3;break;case 2:c=a?30+b*0.5:6+b*0.5;break;case 3:c=a?15+b*0.2:1+b*0.2}return c};MachineParameters.prototype.itemSeriesProbsAtItemSeriesNo=function(d){var a=0;switch(d){case 0:a=10;break;case 1:a=15;break;case 2:a=15;break;case 3:a=7.5;break;case 4:a=7.5;break;case 5:a=10;break;case 6:a=20;break;case 7:a=15}return a};
MachineParameters.prototype.seriesLevel=function(d){for(var a=Number.MAX_VALUE,c=0;c<d.length;c++){var b=d[c];if(b<a)a=b}return a};
function GameVar(a){this.getcrWorld=function(){return a};this.machineParameters=new MachineParameters;this.timeStep=1/60;this.isInMenu=true;this.isFeverMode=false;this.feverBonusCoins=0;this.remainCoins=GameSave.loadRemainCoins();this._autoGenCoinsCounter=30;this._autoGenCoinsCounterTimer=undefined;this._startAutoGenCoinsCountDown(this);this.earnMultiplier=1;this.randomGenCoinTriggerNoTimeLeft=0;this.isTimeChallengeModeEnd=this.isInTimeChallengeMode=false;this._challengeModeCounter=this.challengModeTotalEarnCoins=
0;this._challengeModeCounterTimer=undefined;this.isShowingLeaderboard=false}GameVar.prototype.pauseGame=function(){if(this.timeStep==0){this.timeStep=1/60;this.isInTimeChallengeMode||$("#coin-regen-digits-container").show()}else{this.timeStep=0;$("#coin-regen-digits-container").hide()}};
GameVar.prototype.getFeverModeCoins=function(){this.isFeverMode=true;$("#indicators-container").hide();this.randomGenCoinTriggerNoTimeLeft=0;this.remainCoins+=10;GameSave.saveRemainCoins(this.remainCoins);this.updateChallengeModeTotalEarnCoins(10);this.getcrWorld().tutoCenter.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoFeverMode,"isFirstTimeComeToFeverMode")};
GameVar.prototype.earnFeverModeCoins=function(){console.log("You earned "+this.feverBonusCoins+" bonus coins!");this.remainCoins+=this.feverBonusCoins;GameSave.saveRemainCoins(this.remainCoins);this.updateChallengeModeTotalEarnCoins(this.feverBonusCoins);this.feverBonusCoins=0};
GameVar.prototype.autoRegenCoinsChecking=function(){var a=this;if(this.remainCoins<this.machineParameters.autoGenCoinLimit()&&!this.isInTimeChallengeMode){if(this._autoGenCoinsCounter>9)document.getElementById("coin-regen-digits-text").innerHTML="00:"+this._autoGenCoinsCounter;else document.getElementById("coin-regen-digits-text").innerHTML="00:0"+this._autoGenCoinsCounter;if(this._autoGenCoinsCounterTimer==undefined&&this._autoGenCoinsCounter==0){this.remainCoins++;GameSave.saveRemainCoins(this.remainCoins);
this._autoGenCoinsCounter=this.machineParameters.autoGenCoinCountdownTime();this._autoGenCoinsCounterTimer=setTimeout(function(){a._startAutoGenCoinsCountDown()},1E3)}if(this._autoGenCoinsCounterTimer==undefined&&this._autoGenCoinsCounter==30){$("#coin-regen-digits-container").show();this._autoGenCoinsCounterTimer=setTimeout(function(){a._startAutoGenCoinsCountDown()},1E3)}}else if(this._autoGenCoinsCounterTimer!=undefined){clearTimeout(this._autoGenCoinsCounterTimer);this._autoGenCoinsCounterTimer=
undefined;this._autoGenCoinsCounter=this.machineParameters.autoGenCoinCountdownTime();$("#coin-regen-digits-container").hide()}};GameVar.prototype._startAutoGenCoinsCountDown=function(){var a=this;this.timeStep!=0&&this._autoGenCoinsCounter--;if(this._autoGenCoinsCounter>0)this._autoGenCoinsCounterTimer=setTimeout(function(){a._startAutoGenCoinsCountDown()},1E3);else{clearTimeout(this._autoGenCoinsCounterTimer);this._autoGenCoinsCounterTimer=undefined}};
GameVar.prototype.setChallengeTimeAndStartCount=function(a){this._challengeModeCounter=a;this.isTimeChallengeModeEnd=false;this.challengModeTotalEarnCoins=0;this.updateChallengeModeTotalEarnCoins(this.challengModeTotalEarnCoins);this._startChallengeModeCountDown();$("#challenge-mode-counter-container").show();$("#challenge-mode-score-container").show()};
GameVar.prototype._startChallengeModeCountDown=function(){var a=this;if(this.timeStep!=0){Digits.show(mcLoader.challenge_counter_digits_movieClips,this._challengeModeCounter,false);this._challengeModeCounter--}if(this._challengeModeCounter>=0)this._challengeModeCounterTimer=setTimeout(function(){a._startChallengeModeCountDown()},1E3);else{clearTimeout(this._challengeModeCounterTimer);this._challengeModeCounterTimer=undefined;console.log("Challenge Mode Ends!");this.isTimeChallengeModeEnd=true}};
GameVar.prototype.updateChallengeModeTotalEarnCoins=function(a){if(this.isInTimeChallengeMode){this.challengModeTotalEarnCoins+=a;Digits.show(mcLoader.challenge_score_digits_movieClips,this.challengModeTotalEarnCoins,false)}};
GameVar.prototype.checkCanEndTimeChallengeMode=function(){var a=this.getcrWorld();if(gameVar.remainCoins==0&&a.coins.isFailToEarnMoreCoins&&!a.alertCenter.isShowingAlert){clearTimeout(this._challengeModeCounterTimer);this._challengeModeCounterTimer=undefined;this.isTimeChallengeModeEnd=true}if(this.isInTimeChallengeMode&&this.isTimeChallengeModeEnd&&!a.alertCenter.isShowingAlert&&!this.isShowingLeaderboard){this.isShowingLeaderboard=true;$("#time-is-up-container").show();$("#dim-screen").show();$("#time-is-up")[0].style.top=
"60px";Tween.get($("#time-is-up")[0].style,{loop:false,css:true,override:true}).to({top:200},600).wait(400).call(function(){$("#time-is-up-container").hide();$("#leaderboard-page-container").show()})}};
GameVar.prototype.finishChallengeMode=function(){var a=this.getcrWorld();$("#challenge-mode-counter-container").hide();$("#challenge-mode-score-container").hide();$("#leaderboard-page-container").hide();$("#dim-screen").hide();a.resetcrWorld(false);this.isShowingLeaderboard=this.isTimeChallengeModeEnd=this.isInTimeChallengeMode=false;this.remainCoins=GameSave.loadRemainCoins();this.pauseGame()};
GameVar.prototype.setEarnMultiplier=function(a){this.earnMultiplier=a;if(a==1.5){$("#pin-lv-progress-bar-full").css("background","url(images/pin_lv3_full.png)");$("#pin-lv-progress-bar-empty").css("background","url(images/pin_lv3_empty.png)")}else if(a==1.2){$("#pin-lv-progress-bar-full").css("background","url(images/pin_lv2_full.png)");$("#pin-lv-progress-bar-empty").css("background","url(images/pin_lv2_empty.png)")}else{$("#pin-lv-progress-bar-full").css("background","none");$("#pin-lv-progress-bar-empty").css("background",
"url(images/pin_lv1_full.png)")}a>1&&this.getcrWorld().tutoCenter.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoPinLvUp,"isFirstTimePinLvUp")};GameVar.prototype.reduceRandomGenCoinTriggerNoTime=function(){this.isFeverMode&&this.randomGenCoinTriggerNoTimeLeft>0&&this.randomGenCoinTriggerNoTimeLeft--};
function AlertCenter(a){this.messages=[];this.itemSerieses=[];this.itemClasses=[];this.isShowingAlert=false;this.slotMachine=a}AlertCenter.prototype.requestToShowSlotMachineWithMessage=function(a,b,c){this.messages.unshift(a);this.itemSerieses.unshift(b);this.itemClasses.unshift(c);if(!this.isShowingAlert){this.isShowingAlert=true;this.showSlotMachine()}};
AlertCenter.prototype.showSlotMachine=function(){SoundManagerHelper.playSound("triggerSlotMachine");$("#dim-screen").show();$("#backlight-screen").show();$("#slot-machine-container")[0].style.top="240px";Tween.get($("#slot-machine-container")[0].style,{loop:false,css:true,override:true}).to({top:90},300);var a=new MovieClip($("#slot1"),"images/SlotAnimation.png",57.5,74,5,8,36),b=new MovieClip($("#slot2"),"images/SlotAnimation.png",57.5,74,5,8,36),c=this.getSlotMachineMCEndingNoByMsgNo(this.messages[this.messages.length-
1]),d=c,e=c;if(c==0){do d=Math.floor(Math.random()*10)+1;while(d==3);do e=Math.floor(Math.random()*10)+1;while(e==d||e==3)}var j=this,i=function(f,k,l){f.targetElement.bind("mcFinish",function(m,n){n.targetElement.unbind(m);var g=new MovieClip(k,"images/SlotAnimationEnding"+l+".png",57.5,74,3,4);g.targetElement.bind("mcFinish",function(o,h){h.targetElement.unbind(o);h.targetElement.attr("id")=="slot2"&&Tween.get($("#slot-machine-container")[0].style,{loop:false,css:true,override:true}).wait(500).to({top:480},
100).call(function(){j.finishShowingSlotMachine()})});g.playTillEnd("mcFinish",2)});f.playTillEnd("mcFinish",2)};setTimeout(function(){i(a,$("#slot1"),d)},50);setTimeout(function(){i(b,$("#slot2"),e)},150)};AlertCenter.prototype.finishShowingSlotMachine=function(){var a=this.messages.pop(),b=this.itemSerieses.pop(),c=this.itemClasses.pop();this.slotMachine.getSlotMachinePrize(a,b,c);this.isShowingAlert=false;$("#backlight-screen").hide();$("#dim-screen").hide();this.showAlert(a,b,c)};
AlertCenter.prototype.continueShowAlert=function(){if(this.messages.length!=0&&!this.isShowingAlert){this.isShowingAlert=true;this.showSlotMachine()}};
AlertCenter.prototype.showAlert=function(a){if(a!=Enum.AlertMessage.kMsgGetNothing&&a!=Enum.AlertMessage.kMsgGetOneItem){this.isShowingAlert=true;$("#dim-screen").show();if(a==Enum.AlertMessage.kMsgGetOneCoin||a==Enum.AlertMessage.kMsgGetTwoCoins||a==Enum.AlertMessage.kMsgGetFiveCoins){$("#score-container").css("z-index","10");$("#score-container")[0].style.opacity=1;Tween.get($("#score-container")[0].style,{loop:false,css:true,override:true}).to({opacity:1},250).to({opacity:0.3},250).to({opacity:1},
250).to({opacity:0.3},250).to({opacity:1},250).to({opacity:0.3},250).to({opacity:1},250)}if(a==Enum.AlertMessage.kMsgGet15s||a==Enum.AlertMessage.kMsgGet30s||a==Enum.AlertMessage.kMsgGetMultiplierOnePtTwo||a==Enum.AlertMessage.kMsgGetMultiplierOnePtFive||a==Enum.AlertMessage.kMsgGetFeverMode){$("#pin-lv-progress-bar-container").css("z-index","10");$("#pin-lv-progress-bar-container")[0].style.opacity=1;Tween.get($("#pin-lv-progress-bar-container")[0].style,{loop:false,css:true,override:true}).to({opacity:1},
250).to({opacity:0.3},250).to({opacity:1},250).to({opacity:0.3},250).to({opacity:1},250).to({opacity:0.3},250).to({opacity:1},250)}(new MovieClip($("#alert-word"),"images/prize_alert_large.png",250,250,3,4,10)).stopAt(a);SoundManagerHelper.playSound("prizeGet");var b=this;$("#alert-container")[0].style.opacity=0;Tween.get($("#alert-container")[0].style,{loop:false,css:true,override:true}).to({opacity:1},700).wait(500).to({opacity:0},700).call(function(){b.isShowingAlert=false;$("#dim-screen").hide();
if(a==Enum.AlertMessage.kMsgGetOneCoin||a==Enum.AlertMessage.kMsgGetTwoCoins||a==Enum.AlertMessage.kMsgGetFiveCoins)$("#score-container").css("z-index","0");if(a==Enum.AlertMessage.kMsgGet15s||a==Enum.AlertMessage.kMsgGet30s||a==Enum.AlertMessage.kMsgGetMultiplierOnePtTwo||a==Enum.AlertMessage.kMsgGetMultiplierOnePtFive||a==Enum.AlertMessage.kMsgGetFeverMode)$("#pin-lv-progress-bar-container").css("z-index","0");b.continueShowAlert()})}else this.continueShowAlert()};
AlertCenter.prototype.getSlotMachineMCEndingNoByMsgNo=function(a){switch(a){case Enum.AlertMessage.kMsgGetOneItem:a=0;break;case Enum.AlertMessage.kMsgGetFeverMode:a=2;break;case Enum.AlertMessage.kMsgGetMultiplierOnePtFive:a=4;break;case Enum.AlertMessage.kMsgGetMultiplierOnePtTwo:a=5;break;case Enum.AlertMessage.kMsgGetFiveCoins:a=6;break;case Enum.AlertMessage.kMsgGetTwoCoins:a=7;break;case Enum.AlertMessage.kMsgGetOneCoin:a=8;break;case Enum.AlertMessage.kMsgGet15s:a=9;break;case Enum.AlertMessage.kMsgGet30s:a=
10;break;default:a=0}return a};
function TutoCenter(){this.tutoQueue=[];this.isShowingTuto=false}TutoCenter.prototype.requestToShowTutoWithNoAndCheckKey=function(a,b){GameSave.loadIsFirstTimeShowTutoWithKey(b)&&this.requestToShowTutoWithNo(a)};TutoCenter.prototype.requestToShowTutoWithNo=function(a){for(var b=false,c=0;c<this.tutoQueue.length;c++)if(this.tutoQueue[c]==a)b=true;b||this.tutoQueue.unshift(a)};
TutoCenter.prototype.showTuto=function(){var a=this.tutoQueue.pop();$("#tuto-container").show();$("#dim-screen").show();switch(a){case Enum.TutoNo.kTutoFeverMode:$("#tuto").css("background","url(images/tuto_fever_stage.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimeComeToFeverMode");break;case Enum.TutoNo.kTutoHitFeverTrigger:$("#tuto").css("background","url(images/tuto_fever_trigger.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimeHitFeverTrigger");break;case Enum.TutoNo.kTutoSpotlight:$("#tuto").css("background",
"url(images/tuto_spotlight.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimeShowSpotlight");break;case Enum.TutoNo.kTutoLoseAllChicken:$("#tuto").css("background","url(images/tuto_chicken_lost.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimeLoseAllChicken");mcLoader.tutoChickenLost_movieClips.playLoop(0,undefined,20);mcLoader.tutoChickenLost_movieClips.targetElement.show();break;case Enum.TutoNo.kTutoCanEarn:$("#tuto").css("background","url(images/tuto_coin_table.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimeCanEarn");
break;case Enum.TutoNo.kTutoPinLvUp:$("#tuto").css("background","url(images/tuto_pin_level_up.png)");GameSave.saveIsFirstTimeShowTutoWithKey("isFirstTimePinLvUp")}gameVar.pauseGame()};TutoCenter.prototype.finishTuto=function(){this.isShowingTuto=false;$("#tuto").css("background","none");$("#dim-screen").hide();$("#tuto-container").hide();if(mcLoader.tutoChickenLost_movieClips.isLooping){mcLoader.tutoChickenLost_movieClips.targetElement.hide();mcLoader.tutoChickenLost_movieClips.stopLoop()}gameVar.pauseGame()};
function MovieClip(a,b,d,c,e,f,g){this.targetElement=a;this.row=e;this.column=f;this.totalFrame=g;if(g==undefined)this.totalFrame=e*f;this.curFrameNo=0;this.backToCurrentFrameNo=-1;this.playedFrameCount=0;this.isLooping=this.isPaused=false;this.repeatedTime=1;this.tickCount=0;this.mcWidth=d;this.mcHeight=c;this.targetElement.css({"background-image":"url("+b+")",width:this.mcWidth+"px",height:this.mcHeight+"px"})}
MovieClip.prototype.stopAt=function(a){if(this.curFrameNo!=a){this.targetElement.css({"background-position":-(this.mcWidth*(a%this.column))+"px "+-(this.mcHeight*Math.floor(a/this.column))+"px"});this.curFrameNo=a}};MovieClip.prototype.stopAtNextFrame=function(a){var b;if(a=="forward"){b=this.curFrameNo+1;if(b==this.totalFrame)b=0}if(a=="backward"){b=this.curFrameNo-1;if(b<0)b=this.totalFrame-1}this.stopAt(b);this.playedFrameCount++};
MovieClip.prototype.playTillEnd=function(a,b){if(this.curFrameNo+1<this.totalFrame){this.action=function(){this.stopAtNextFrame("forward");this.playTillEnd(a,b)};timeline.addToTimeline(this,b)}else{timeline.removeFromTimeline(this);this.targetElement.trigger(a,this)}};
MovieClip.prototype.playBackTillHome=function(a,b){if(this.curFrameNo-1>=0){this.action=function(){this.stopAtNextFrame("backward");this.playBackTillHome(a,b)};timeline.addToTimeline(this,b)}else{timeline.removeFromTimeline(this);this.targetElement.trigger(a,this)}};
MovieClip.prototype.stopAtForTimeAndBackToCurrent=function(a,b){this.isPaused=true;if(this.backToCurrentFrameNo==-1)this.backToCurrentFrameNo=this.curFrameNo;this.action=function(){this.stopAt(this.backToCurrentFrameNo);this.backToCurrentFrameNo=-1;this.isPaused=false;timeline.removeFromTimeline(this)};this.stopAt(a);timeline.addToTimeline(this,b)};
MovieClip.prototype.playLoop=function(a,b,d){this.isLooping=true;var c=this.curFrameNo+1;if(c==this.totalFrame){c=0;this.repeatedTime++}if(a==0)this.repeatedTime=a;if(c<this.totalFrame&&this.repeatedTime<=a){this.action=function(){this.stopAtNextFrame("forward");this.playLoop(a,b,d)};timeline.addToTimeline(this,d)}else{this.stopLoop();this.repeatedTime=0;b!=undefined&&this.targetElement.trigger(b,this)}};MovieClip.prototype.stopLoop=function(){if(this.isLooping){this.isLooping=false;timeline.removeFromTimeline(this)}};
function MovieClipLoader(){this.score_digits_movieClips=[];this.earn_coin_digits_movieClips=[];this.challenge_counter_digits_movieClips=[];this.challenge_score_digits_movieClips=[];this.fever_slot_bonus_movieClips=[];this.fever_bonus_digits_movieClips=[];this.score_digits_movieClips.push(new MovieClip($("#score-units"),"images/digit_coin.png",10,14,3,4));this.score_digits_movieClips.push(new MovieClip($("#score-tens"),"images/digit_coin.png",10,14,3,4));this.score_digits_movieClips.push(new MovieClip($("#score-hundreds"),
"images/digit_coin.png",10,14,3,4));this.score_digits_movieClips.push(new MovieClip($("#score-thousands"),"images/digit_coin.png",10,14,3,4));this.score_digits_movieClips.push(new MovieClip($("#score-tenThousands"),"images/digit_coin.png",10,14,3,4));this.earn_coin_digits_movieClips.push(new MovieClip($("#earn-coin-units"),"images/digit.png",14,16,3,4));this.earn_coin_digits_movieClips.push(new MovieClip($("#earn-coin-tens"),"images/digit.png",14,16,3,4));this.earn_coin_digits_movieClips.push(new MovieClip($("#earn-coin-hundreds"),
"images/digit.png",14,16,3,4));this.earn_coin_digits_movieClips.push(new MovieClip($("#earn-coin-plus-sign"),"images/digit.png",14,16,3,4));this.earn_coin_digits_movieClips[3].stopAt(10);this.challenge_counter_digits_movieClips.push(new MovieClip($("#challenge-mode-counter-units"),"images/digit.png",14,16,3,4));this.challenge_counter_digits_movieClips.push(new MovieClip($("#challenge-mode-counter-tens"),"images/digit.png",14,16,3,4));this.challenge_counter_digits_movieClips.push(new MovieClip($("#challenge-mode-counter-hundreds"),
"images/digit.png",14,16,3,4));this.challenge_score_digits_movieClips.push(new MovieClip($("#challenge-mode-score-units"),"images/digit_coin.png",10,14,3,4));this.challenge_score_digits_movieClips.push(new MovieClip($("#challenge-mode-score-tens"),"images/digit_coin.png",10,14,3,4));this.challenge_score_digits_movieClips.push(new MovieClip($("#challenge-mode-score-hundreds"),"images/digit_coin.png",10,14,3,4));this.challenge_score_digits_movieClips.push(new MovieClip($("#challenge-mode-score-thousands"),
"images/digit_coin.png",10,14,3,4));this.challenge_score_digits_movieClips.push(new MovieClip($("#challenge-mode-score-tenThousands"),"images/digit_coin.png",10,14,3,4));this.stage_door_movieClips=new MovieClip($("#stage-door"),"images/stage_door.png",400,50,7,1);this.fever_trigger_1_digit_movieClips=new MovieClip($("#fever-trigger-1-digit"),"images/digit2.png",17,20,3,4);this.fever_trigger_1_digit_movieClips.stopAt(1);this.fever_trigger_3_digit_movieClips=new MovieClip($("#fever-trigger-3-digit"),
"images/digit2.png",17,20,3,4);this.fever_trigger_3_digit_movieClips.stopAt(3);this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot0-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot1-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot2-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot3-bonus"),"images/digit2.png",17,
20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot4-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot5-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot6-bonus"),"images/digit2.png",17,20,3,4));this.fever_slot_bonus_movieClips.push(new MovieClip($("#fever-slot7-bonus"),"images/digit2.png",17,20,3,4));this.fever_bonus_border_movieClips=new MovieClip($("#fever-bonus-border"),
"images/bonus_border.png",48,21,2,1);this.fever_bonus_digits_movieClips.push(new MovieClip($("#fever-bonus-units"),"images/digit.png",14,16,3,4));this.fever_bonus_digits_movieClips.push(new MovieClip($("#fever-bonus-tens"),"images/digit.png",14,16,3,4));this.fever_bonus_digits_movieClips.push(new MovieClip($("#fever-bonus-hundreds"),"images/digit.png",14,16,3,4));this.plus_movieClips=new MovieClip($(".plus-sign"),"images/digit2.png",17,20,3,4);this.plus_movieClips.stopAt(10);for(var a=0;a<this.fever_slot_bonus_movieClips.length;a++)this.fever_slot_bonus_movieClips[a].targetElement.css({top:canvasHeight-
LOW_UI_SPACE-40+"px",left:(xPosOfSlots[a]+xPosOfSlots[a+1])/2-this.fever_slot_bonus_movieClips[a].targetElement.width()/2+"px"});this.slotMachine_movieClips=new MovieClip($("#slot-machine"),"images/slot_machine.png",250,250,1,1);this.tutoChickenLost_movieClips=new MovieClip($("#tuto-chicken-lost-animation"),"images/tuto_chicken_lost_animation.png",204,105,3,1)};
function SpritesLoader(){this.image=[];this.isReady=[];var a=[];a[Enum.Sprites.kSpritesSlide]="images/slide.png";a[Enum.Sprites.kSpritesWindmillLarge]="images/windmill_large.png";a[Enum.Sprites.kSpritesWindmillSmall]="images/windmill_small.png";a[Enum.Sprites.kSpritesWindmillTop]="images/windmill_top.png";a[Enum.Sprites.kSpritesLaunchTunnel]="images/tunnel.png";a[Enum.Sprites.kSpritesMouse]="images/mouse.png";for(i=0;i<Enum.size(Enum.Sprites);i++){this.image.push(new Image);this.isReady.push(false);
var b=this.image[i];this.isReady[i]=true;b.onload=void 0;this.image[i].src=a[i]}};
function SpritesHelper(){}
SpritesHelper.update=function(b,a,d){for(b=b.GetBodyList();b!=null;b=b.GetNext()){a=b.GetUserData();if(a!=undefined){if(a.type=="coin"){var c=a.graphics,e=c.chickEmoMC,f=c.xPos-e.mcWidth/2+"px",g=c.yPos-e.mcHeight/2+"px";c=c.angle*180/Math.PI+"deg";e.targetElement.css({"-webkit-transform":"translate3d("+f+", "+g+",0) rotate3d(0,0,1,"+c+")","-moz-transform":"translate("+f+", "+g+") rotate("+c+")"})}if(a.type!="nail"&&a.graphics!=undefined){a.graphics.xPos=MetersToPoints(b.GetPosition().x);a.graphics.yPos=
MetersToPoints(b.GetPosition().y);a.graphics.angle=b.GetAngle();if(a.type=="launchTunnel")a.graphics.angle=b.GetAngle()+90*Math.PI/180;if(a.type=="coin"&&a.isCoinPassedBtmSlot&&d.shouldClearChickSprite)if(!a.graphics.isExploding){a.graphics.isExploding=true;a.graphics.explosionMC.targetElement.css({left:a.graphics.xPos-a.graphics.explosionMC.mcWidth/2+"px",top:canvasHeight/CANVASHEIGHT_DIVISION*17-a.graphics.explosionMC.mcHeight/2+"px"});a.graphics.explosionMC.targetElement.show();a.graphics.explosionMC.targetElement.bind("mcFinish",
function(i,h){h.targetElement.unbind(i);h.targetElement.remove()});a.graphics.explosionMC.stopAt(0);a.graphics.explosionMC.playLoop(2,"mcFinish",4)}b.SetUserData(a);a.graphics.isReady&&SpritesHelper.drawSpritesByUserData(a.graphics)}if(a.type=="nail")if(gameVar.isFeverMode){if(!a.graphics.feverNailMC.isLooping){a.graphics.feverNailMC.targetElement.show();a.graphics.nailMC.targetElement.hide();a.graphics.feverNailMC.playLoop(0,undefined,6)}}else a.graphics.feverNailMC.stopLoop()}}};
SpritesHelper.drawSpritesByUserData=function(b){var a=b.xPos-b.image.width/2,d=b.yPos-b.image.height/2;b.element.css({"-webkit-transform":"translate3d("+a+"px, "+d+"px,0) rotate3d(0,0,1,"+b.angle*180/Math.PI+"deg)","-moz-transform":"translate("+a+"px, "+d+"px) rotate("+b.angle*180/Math.PI+"deg)"})};
function SpotLights(){}
SpotLights.prototype.show=function(c,a,b){this.hideAll(b);var d=[];d=SlotsHelper.slotIndexesToBeHighlighted(a);if(c>=6)b.slotIndexesToTriggerSlotMachine=SlotsHelper.slotIndexesToGetConsecutiveCount(6,a);for(c=0;c<d.length;c++){a=b.btmSensors.b2body[d[c]].GetUserData();a.spotLightMC.targetElement.show();a.spotLightMC.playLoop(0,undefined,8);a.spotLightMC.targetElement[0].style.opacity=1;Tween.get(a.spotLightMC.targetElement[0].style,{loop:true,css:true,override:true}).to({opacity:1},300).to({opacity:0.55},
300).to({opacity:1},300)}};SpotLights.prototype.hideAll=function(c){for(var a=0;a<SLOT_AMOUNT;a++){var b=c.btmSensors.b2body[a].GetUserData();b.spotLightMC.targetElement.hide();b.isTweening=false;b.spotLightMC.stopLoop();Tween.removeTweens(b.spotLightMC.targetElement[0].style)}};
function BtmSensors(a){this.b2body=[];for(var b=0;b<SLOT_AMOUNT;b++){var c=(xPosOfSlots[b]+xPosOfSlots[b+1])/2,d=createBodyDef("static",b2Vec2_px2m(c,canvasHeight-LOW_UI_SPACE));d.userData.type="btmSensor";d.userData.sensorId=b;d.userData.isTweening=false;var e=$("#spotlight").clone().removeAttr("id").attr("class","spotlight-copy").appendTo("#spotlight-container");e.css({left:c-e.width()/2+"px",top:canvasHeight-LOW_UI_SPACE-e.height()+"px"});d.userData.spotLightMC=new MovieClip(e,"images/spotlight.png",
86,107,1,2);this.b2body[b]=a.CreateBody(d);c=createFixtureDef("polygon",0.12,0.05,undefined,0,0.25,1);c.filter.categoryBits=1;this.b2body[b].CreateFixture(c)}}BtmSensors.prototype.makeSolid=function(){for(var a=0;a<SLOT_AMOUNT;a++)this.b2body[a].GetFixtureList().SetSensor(false)};
BtmSensors.prototype.makeTransparent=function(){for(var a=0;a<SLOT_AMOUNT;a++){this.b2body[a].GetFixtureList().SetSensor(true);this.b2body[a].GetUserData().spotLightMC.targetElement.hide();this.b2body[a].GetUserData().spotLightMC.isLooping&&this.b2body[a].GetUserData().spotLightMC.stopLoop();Tween.removeTweens(this.b2body[a].GetUserData().spotLightMC.targetElement[0].style)}};
function Slots(b){this.currentStatus=[];this.backUpStatus=[];this.slotIndexesToTriggerSlotMachine=[];this.consecutiveCount=[];this.slotsTransparentCount=0;this.shouldClearChickSprite=false;this.btmSensors=new BtmSensors(b);this.spotLights=new SpotLights;this.getb2world=function(){return b}}
Slots.prototype.shouldClearSlotsChecking=function(b,a,c){for(var d=false,e=0;e<this.currentStatus.length;e++)if(this.currentStatus[e]==b||this.currentStatus[e]==a)d=true;if(d){for(b=this.getb2world().GetBodyList();b!=null;b=b.GetNext()){a=b.GetUserData();d=12;if(Math.floor(Math.random()*2)>0)d=15;a!=undefined&&a.type=="coin"&&a.graphics.chickEmoMC.stopAtForTimeAndBackToCurrent(d,120)}SoundManagerHelper.playSound("chickenLose");this.makeBtmSensorTransparent(true);c.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoLoseAllChicken,
"isFirstTimeLoseAllChicken")}};Slots.prototype.updateCurrentStatus=function(b,a){this.currentStatus[b]=a;a.GetUserData().isInSlot=true};Slots.prototype.backUpCurrentStatus=function(){this.backUpStatus=this.currentStatus.slice();this.btmSensors.makeTransparent()};
Slots.prototype.restoreBackUpStatus=function(b){for(var a=0;a<this.backUpStatus.length;a++)if(this.backUpStatus[a]!=undefined){var c=b.createAt(canvasWidth/SLOT_AMOUNT*(a+0.5),canvasHeight-LOW_UI_SPACE-30),d=c.GetUserData();d.isCoinPassedBtmSlot=true;c.SetUserData(d)}};Slots.prototype.coinsCountInSlot=function(){for(var b=0,a=0;a<SLOT_AMOUNT;a++)this.currentStatus[a]!=undefined&&b++;return b};
Slots.prototype.currentStatusInNumber=function(){for(var b=[],a=0;a<SLOT_AMOUNT;a++){b[a]=0;if(this.currentStatus[a]!=undefined)b[a]=1}return b};Slots.prototype.checkZombie=function(b){for(var a=[],c=0;c<SLOT_AMOUNT;c++)if(this.currentStatus[c]!=undefined)if(this.currentStatus[c]==b){a.push(c);this.spotLights.hideAll(this)}for(b=0;b<a.length;b++){this.currentStatus[b]=undefined;console.log("zombie slotstatus cleared!")}};
Slots.prototype.canSlotTriggerSlotMachine=function(b){for(var a=false,c=0;c<this.slotIndexesToTriggerSlotMachine.length;c++)if(b==this.slotIndexesToTriggerSlotMachine[c]){console.log("consecutive more than 6!!!");a=true}return a};
Slots.prototype.btmSensorTransparentChecking=function(){if(this.slotsTransparentCount>0){this.slotsTransparentCount++;if(this.slotsTransparentCount>60){this.btmSensors.makeSolid();this.slotsTransparentCount=0;this.shouldClearChickSprite=false;this.currentStatus=[];this.consecutiveCount=[];this.slotIndexesToTriggerSlotMachine=[]}}};Slots.prototype.makeBtmSensorTransparent=function(b){this.btmSensors.makeTransparent();this.shouldClearChickSprite=b;this.slotsTransparentCount=1};
Slots.prototype.changeSlotsNormal=function(){SoundManagerHelper.stopSound("feverModeBgm");SoundManagerHelper.loopSound("bgm");gameVar.isFeverMode=false;if(mcLoader.stage_door_movieClips.isPaused){mcLoader.stage_door_movieClips.targetElement.bind("mcFinish",function(b,a){a.targetElement.unbind(b);a.isPaused=false});mcLoader.stage_door_movieClips.playBackTillHome("mcFinish",5);SoundManagerHelper.playSound("btmDoorClose")}$("#fever-slot-bonus-container").hide();$("#fever-bonus-container").hide();mcLoader.fever_bonus_border_movieClips.stopLoop();
this.spotLights.hideAll(this);console.log("You totally earned "+gameVar.feverBonusCoins+"coins in fever mode");gameVar.earnFeverModeCoins();this.btmSensors.makeSolid()};
Slots.prototype.changeSlotsFever=function(){SoundManagerHelper.stopSound("bgm");SoundManagerHelper.loopSound("feverModeBgm");SoundManagerHelper.playSound("btmDoorOpen");this.backUpCurrentStatus();mcLoader.stage_door_movieClips.targetElement.bind("mcFinish",function(e,f){f.targetElement.unbind(e);f.isPaused=true});mcLoader.stage_door_movieClips.playTillEnd("mcFinish",5);$("#fever-bonus-container").show();mcLoader.fever_bonus_border_movieClips.playLoop(0,undefined,15);Digits.show(mcLoader.fever_bonus_digits_movieClips,
0,false);var b=[[2,1,0,2,0,5,0,1],[2,1,0,5,0,2,0,1],[2,1,0,5,0,1,0,2],[0,2,0,1,2,1,0,5],[0,2,0,5,0,1,2,1],[0,2,2,1,0,5,0,1],[1,0,2,0,5,0,1,2],[1,0,5,0,2,0,1,2],[1,0,5,0,1,2,2,0],[2,0,5,0,1,2,1,0],[2,0,1,0,5,0,1,2],[5,0,1,2,1,0,2,0]];b=b[Math.floor(Math.random()*b.length)].slice();for(var a=0;a<SLOT_AMOUNT;a++){var c=this.btmSensors.b2body[a].GetUserData(),d=b[a];c.bonusVal=d;mcLoader.fever_slot_bonus_movieClips[a].stopAt(d);if(d>0){mcLoader.fever_slot_bonus_movieClips[a].targetElement.children().show();
mcLoader.fever_slot_bonus_movieClips[a].targetElement.css({left:(xPosOfSlots[a]+xPosOfSlots[a+1])/2-mcLoader.fever_slot_bonus_movieClips[a].targetElement.width()/2+5+"px"})}this.consecutiveCount=[];this.currentStatus=[]}$("#fever-slot-bonus-container").show()};
Slots.prototype.hitByCoin=function(b,a,c,d){a.GetUserData().coinInMachineTime=0;if(gameVar.isFeverMode){if(!a.GetUserData().isCoinPassedBtmSlot){gameVar.feverBonusCoins+=b.GetUserData().bonusVal;Digits.show(mcLoader.fever_bonus_digits_movieClips,gameVar.feverBonusCoins,false);if(b.GetUserData().bonusVal>0){if(!b.GetUserData().isTweening){b.GetUserData().isTweening=true;var e=b.GetUserData().spotLightMC.targetElement;e.show();e[0].style.opacity=1;Tween.get(e[0].style,{loop:false,css:true,override:true}).to({opacity:0},
300).to({opacity:1},300).to({opacity:0},300).to({opacity:1},300).to({opacity:0},300).call(function(){e.hide();b.GetUserData().isTweening=false})}SoundManagerHelper.playSound("feverModeChickenPassSlot")}a.GetUserData().isCoinPassedBtmSlot=true}}else{var f=b.GetUserData().sensorId;this.currentStatus[f]!=a&&this.slotsTransparentCount==0&&a.GetUserData().graphics.yPos<=411&&this.updateCurrentStatus(f,a);this.canSlotTriggerSlotMachine(f)&&c.triggerOnce();var g=this.coinsCountInSlot(),h=this.currentStatusInNumber();
if(!a.GetUserData().isTriggeredToShowSpotLight&&this.slotsTransparentCount==0){this.spotLights.show(g,h,this);a.GetUserData().isTriggeredToShowSpotLight=true;d.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoSpotlight,"isFirstTimeShowSpotlight")}if(!a.GetUserData().isCoinPassedBtmSlot&&(f==0||f==7))c.triggerSlotMachineCount<MAX_TRIGGER_SLOT_MACHINE_COUNT&&c.triggerOnce();a.GetUserData().isCoinPassedBtmSlot=true}};
function SlotsHelper(){}SlotsHelper.countConsecutive=function(b){for(var c=b.slice(),a=0,d=0;d<b.length;d++)if(b[d]==1)a++;else{for(var e=d-a;e<d;e++)c[e]=a;a=0}if(a>0){d=b.length;for(e=b.length-a;e<d;e++)c[e]=a}return c};SlotsHelper.countMaxConsecutive=function(b){b=SlotsHelper.countConsecutive(b.slice());for(var c=0,a=0;a<b.length;a++)if(b[a]>c)c=b[a];return c};
SlotsHelper.slotIndexesToGetConsecutiveCount=function(b,c){for(var a=[],d=0;d<c.length;d++)if(c[d]==0){var e=c.slice();e[d]=1;SlotsHelper.countMaxConsecutive(e)>=b&&a.push(d)}return a};SlotsHelper.slotIndexesToBeHighlighted=function(b){for(var c=[],a=0;a<b.length;a++)if(b[a]==0){a==0&&b[a+1]==1&&c.push(a);a==b.length-1&&b[a-1]==1&&c.push(a);if(a!=0&&a!=b.length-1&&(b[a-1]==1||b[a+1]==1))c.push(a)}return c};
function Coins(a,b){this.reloadTimeLeft=this.coinsCountInMachine=0;this.isFailToEarnMoreCoins=this.isTweeningTapMeToEarn=this.canEarnNow=false;this.getb2world=function(){return a};this.getloader=function(){return b}}
Coins.prototype.createAt=function(a,b,c){var d=this.getb2world();this.getloader();if(typeof c=="undefined"?false:c){a=Math.floor(Math.random()*canvasWidth);if(a<MetersToPoints(SIDEWALL_WIDTH)+slotWidthPX/2)a=MetersToPoints(SIDEWALL_WIDTH)+slotWidthPX/2;if(a>canvasWidth-(MetersToPoints(SIDEWALL_WIDTH)+slotWidthPX/2))a=canvasWidth-(MetersToPoints(SIDEWALL_WIDTH)+slotWidthPX/2);if(a>xPosOfSlots[3]&&a<=canvasWidth/2)a=xPosOfSlots[3];if(a<xPosOfSlots[5]&&a>canvasWidth/2)a=xPosOfSlots[5];b=50}else{a=a;
b=b}c=createBodyDef("dynamic",b2Vec2_px2m(a,b));c.userData.type="coin";c.userData.coinInMachineTime=0;c.userData.isInSlot=false;c.userData.isCoinPassedBtmSlot=false;c.userData.isTriggeredToShowSpotLight=false;var e=$("#explosion").clone().removeAttr("id").attr("class","explosion-copy").appendTo("#explosion-container"),f=$("#chickEmo").clone().removeAttr("id").attr("class","chickEmo-copy").appendTo("#chickEmo-container");f=new MovieClip(f,"images/chickEmo.png",40,40,5,4);var g=0;if(Math.floor(Math.random()*
2)>0)g=2;f.stopAt(g);c.userData.graphics={xPos:a,yPos:b,angle:0,alpha:1,isExploding:false,explosionMC:new MovieClip(e,"images/explosion.png",64,64,2,2),chickEmoMC:f};d=d.CreateBody(c);a=createFixtureDef("circle",undefined,undefined,PointsToMeters(slotWidthPX-2)/2,0.5,0.45,0.45);a.filter.categoryBits=16;a.filter.maskBits=17;d.CreateFixture(a);return d};Coins.prototype.reduceReloadTime=function(){this.reloadTimeLeft>0&&this.coinsCountInMachine<gameVar.machineParameters.coinsInMachineLimit()&&this.reloadTimeLeft--};
Coins.prototype.canAddNewCoinsAtFeverModeChecking=function(a){if(gameVar.isFeverMode&&a.nailLvUpCounterTimer==undefined&&this.coinsCountInMachine!=0)this.reloadTimeLeft=RELOAD_TIME};
Coins.prototype.addNewCoin=function(a){if(this.reloadTimeLeft==0&&gameVar.remainCoins>0){SoundManagerHelper.playSound("launchChicken");gameVar.remainCoins--;GameSave.saveRemainCoins(gameVar.remainCoins);var b=this.createAt(canvasWidth/2,0);a=a.tStickLJoint.GetJointAngle();b.ApplyForce(b2Vec2_px2m(1500*Math.sin(a),(500+Math.floor(Math.random()*250))*Math.cos(a)),b.GetWorldCenter());this.reloadTimeLeft=RELOAD_TIME}if(gameVar.remainCoins<=0||this.coinsCountInMachine>=gameVar.machineParameters.coinsInMachineLimit())SoundManagerHelper.playSound("noMoreChicken")};
Coins.prototype.earnCoin=function(a){if(this.canEarnNow){var b=this.calculateEarnCoins(a);b=Math.round(b*gameVar.earnMultiplier);Digits.show(mcLoader.earn_coin_digits_movieClips,b,true);$("#earn-coin-digits-container")[0].style.top="350px";$("#earn-coin-digits-container")[0].style.opacity=1;Tween.get($("#earn-coin-digits-container")[0].style,{loop:false,css:true,override:true}).to({top:220},300).wait(800).to({opacity:0},200);gameVar.remainCoins+=b;GameSave.saveRemainCoins(gameVar.remainCoins);gameVar.updateChallengeModeTotalEarnCoins(b);
a.makeBtmSensorTransparent(false);SoundManagerHelper.playSound("btmDoorOpen");for(b=0;b<SLOT_AMOUNT;b++)if(a.currentStatus[b]!=undefined){var c=a.currentStatus[b].GetUserData();c.type=="coin"&&c.graphics.chickEmoMC.stopAt(13)}mcLoader.stage_door_movieClips.targetElement.bind("mcFinish",function(d,e){e.targetElement.unbind(d);e.playBackTillHome("mcFinish",5);SoundManagerHelper.playSound("btmDoorClose")});mcLoader.stage_door_movieClips.playTillEnd("mcFinish",5);SoundManagerHelper.playSound("earnCoin")}else SoundManagerHelper.playSound("noMoreChicken")};
Coins.prototype.calculateEarnCoins=function(a){var b=0;b=0;var c=1,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;do{if(c>=SLOT_AMOUNT)c=SLOT_AMOUNT-1;if(a.consecutiveCount[b]!=a.consecutiveCount[c]||b==c)switch(a.consecutiveCount[b]){case 1:d++;break;case 2:e++;break;case 3:f++;break;case 4:g++;break;case 5:h++;break;case 6:i++;break;case 7:j++;break;case 8:k++}b++;c++}while(b<SLOT_AMOUNT);return b=d*0+e*4+f*6+g*14+h*25+i*60+j*140+k*500};
Coins.prototype.canEarnNowChecking=function(a,b){this.isFailToEarnMoreCoins=this.canEarnNow=false;var c=0,d=a.coinsCountInSlot(),e=a.currentStatusInNumber();a.consecutiveCount=SlotsHelper.countConsecutive(e);for(e=0;e<SLOT_AMOUNT;e++){var f=a.consecutiveCount[e];if(f>c)c=f}if(c>=2&&this.coinsCountInMachine==d&&!gameVar.isFeverMode&&a.slotsTransparentCount==0){this.canEarnNow=true;b.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoCanEarn,"isFirstTimeCanEarn");if(!this.isTweeningTapMeToEarn){this.isTweeningTapMeToEarn=
true;$("#tap-me-to-earn-container").show();$("#tap-me-to-earn-container")[0].style.opacity=1;Tween.get($("#tap-me-to-earn-container")[0].style,{loop:true,css:true,override:true}).to({opacity:0.85},450).to({opacity:0.25},450).to({opacity:0.85},450)}}else if(this.isTweeningTapMeToEarn){this.isTweeningTapMeToEarn=false;$("#tap-me-to-earn-container").hide();Tween.removeTweens($("#tap-me-to-earn-container")[0].style)}if(gameVar.isInTimeChallengeMode&&c<2&&this.coinsCountInMachine==d&&!gameVar.isFeverMode&&
a.slotsTransparentCount==0)this.isFailToEarnMoreCoins=true};Coins.prototype.clearAllCoins=function(a,b){for(var c=this.getb2world().GetBodyList();c!=null;c=c.GetNext()){var d=c.GetUserData();if(d!=undefined)if(d.type=="coin"){a.bodyListToRemove[a.bodyRemoveCount]=c;a.bodyRemoveCount++;if(b){gameVar.remainCoins++;GameSave.saveRemainCoins(gameVar.remainCoins)}}}};
Coins.prototype.b2BodiesChecking=function(a){var b=this.getb2world();this.coinsCountInMachine=0;for(b=b.GetBodyList();b!=null;b=b.GetNext()){var c=b.GetUserData();if(c!=undefined)if(c.type=="coin"){this.coinsCountInMachine++;b.GetUserData().coinInMachineTime++;if(b.GetUserData().coinInMachineTime>MAX_COIN_LIVE_TIME){a.bodyListToRemove[a.bodyRemoveCount]=b;a.bodyRemoveCount++;gameVar.remainCoins++;GameSave.saveRemainCoins(gameVar.remainCoins)}if(!b.IsAwake()){c=25;if(Math.floor(Math.random()*2)==1)c=
-25;if(b.GetUserData().isInSlot)c=0;b.ApplyImpulse(b2Vec2_px2m(c,-15),b.GetWorldCenter());c=b.GetAngle()*180/Math.PI;if(c%360>0&&c%360<=180||c%360<=-180&&c%360>-360)b.SetAngularVelocity(-60/180*Math.PI);if(c%360>=180&&c%360<360||c%360<0&&c%360>=-180)b.SetAngularVelocity(60/180*Math.PI)}}}};
function BoundingBox(c){this.bodyListToRemove=[];this.bodyRemoveCount=0;this.getb2world=function(){return c};var a=createBodyDef("static",b2Vec2_px2m(canvasWidth/2,-200));a.userData.type="topWall";a=c.CreateBody(a);var b=createBodyDef("static",b2Vec2_px2m(canvasWidth/2,canvasHeight+20));b.userData.type="btmWall";b=c.CreateBody(b);var d=createFixtureDef("polygon",PointsToMeters(canvasWidth/2),0.1,undefined,0,0,1);b.CreateFixture(d);a.CreateFixture(d);a=createBodyDef("static",b2Vec2_px2m(0,canvasHeight/
2));b=createBodyDef("static",b2Vec2_px2m(canvasWidth,canvasHeight/2));a.userData.type="sideWall";b.userData.type="sideWall";a=c.CreateBody(a);b=c.CreateBody(b);d=createFixtureDef("polygon",SIDEWALL_WIDTH,PointsToMeters(canvasHeight),undefined,0,0,1);d.filter.categoryBits=1;a.CreateFixture(d);b.CreateFixture(d);a=createFixtureDef("polygon",SLOTWALL_WIDTH,SLOTWALL_HEIGHT,undefined,0,0.25,1);for(b=1;b<SLOT_AMOUNT;b++){d=createBodyDef("static",b2Vec2_px2m(xPosOfSlots[b],canvasHeight-LOW_UI_SPACE));d.userData.type=
"slotWall";c.CreateBody(d).CreateFixture(a)}}BoundingBox.prototype.addCoinBodyToRemoveList=function(c){this.bodyListToRemove[this.bodyRemoveCount]=c;this.bodyRemoveCount++};
BoundingBox.prototype.removeUnusedCoinBodies=function(){var c=this.getb2world();if(this.bodyRemoveCount>0){for(var a=0;a<this.bodyRemoveCount;a++)if(this.bodyListToRemove[a]!=undefined)if(this.bodyListToRemove[a].GetUserData().type=="coin"){this.bodyListToRemove[a].GetUserData().graphics.explosionMC.isLooping||this.bodyListToRemove[a].GetUserData().graphics.explosionMC.targetElement.remove();this.bodyListToRemove[a].GetUserData().graphics.chickEmoMC.targetElement.remove();c.DestroyBody(this.bodyListToRemove[a])}this.bodyRemoveCount=
0;this.bodyListToRemove=[]}};
function LaunchTunnel(d,c){var a=createBodyDef("dynamic",b2Vec2_px2m(canvasWidth/2-slotWidthPX/2-3,0));a.userData.type="launchTunnel";a.userData.graphics={isReady:c.isReady[Enum.Sprites.kSpritesLaunchTunnel],image:c.image[Enum.Sprites.kSpritesLaunchTunnel],element:$("<div class='game-physics-element'><img src='"+c.image[Enum.Sprites.kSpritesLaunchTunnel].src+"'></div>"),xPos:canvasWidth/2-slotWidthPX/2-3,yPos:0,angle:Math.PI/2,alpha:1};$("#game-physics").append(a.userData.graphics.element);var e=
createBodyDef("dynamic",b2Vec2_px2m(canvasWidth/2+slotWidthPX/2+3,0));e.userData.type="launchTunnel";e.userData.graphics={isReady:c.isReady[Enum.Sprites.kSpritesLaunchTunnel],image:c.image[Enum.Sprites.kSpritesLaunchTunnel],element:$("<div class='game-physics-element'><img src='"+c.image[Enum.Sprites.kSpritesLaunchTunnel].src+"'></div>"),xPos:canvasWidth/2+slotWidthPX/2+3,yPos:0,angle:Math.PI/2,alpha:1};$("#game-physics").append(e.userData.graphics.element);var f=createBodyDef("static",b2Vec2_px2m(canvasWidth/
2,0));a=d.CreateBody(a);e=d.CreateBody(e);f=d.CreateBody(f);var b=createFixtureDef("polygon",0.05,0.6,undefined,1E10,0,0.1),h=createFixtureDef("polygon",0.05,0.6,undefined,1E10,0,0.1),g=createFixtureDef("circle",undefined,undefined,PointsToMeters((slotWidthPX-2)/2),0,0,0);g.filter.categoryBits=256;a.CreateFixture(b);e.CreateFixture(h);f.CreateFixture(g);b=new b2RevoluteJointDef;b.Initialize(a,f,b2Vec2_px2m(canvasWidth/2,0));b.lowerAngle=-65/180*Math.PI;b.upperAngle=65/180*Math.PI;b.enableLimit=true;
b.maxMotorTorque=1.0E20;b.motorSpeed=1;b.enableMotor=true;a=new b2RevoluteJointDef;a.Initialize(e,f,b2Vec2_px2m(canvasWidth/2,0));a.lowerAngle=-65/180*Math.PI;a.upperAngle=65/180*Math.PI;a.enableLimit=true;a.maxMotorTorque=1.0E20;a.motorSpeed=1;a.enableMotor=true;this.tStickLJoint=d.CreateJoint(b);this.tStickRJoint=d.CreateJoint(a)}
LaunchTunnel.prototype.motorSpeedChecking=function(){var d=this.tStickLJoint.GetJointAngle(),c=this.tStickRJoint.GetJointAngle();if(d>=65/180*Math.PI&&c>=65/180*Math.PI){this.tStickLJoint.SetMotorSpeed(-1);this.tStickRJoint.SetMotorSpeed(-1)}if(d<-65/180*Math.PI&&c<-65/180*Math.PI){this.tStickLJoint.SetMotorSpeed(1);this.tStickRJoint.SetMotorSpeed(1)}};
function Mouse(c,d){this.isMouseAlreadyHit=false;this.mouseAlreadyHitCount=0;var a=createBodyDef("dynamic",b2Vec2_px2m(canvasWidth/2,canvasHeight/CANVASHEIGHT_DIVISION*8));a.userData.type="mouse";a.userData.graphics={isReady:d.isReady[Enum.Sprites.kSpritesMouse],image:d.image[Enum.Sprites.kSpritesMouse],element:$("<div class='game-physics-element'><img src='"+d.image[Enum.Sprites.kSpritesMouse].src+"'></div>"),xPos:canvasWidth/2,yPos:canvasHeight/CANVASHEIGHT_DIVISION*8,angle:0,alpha:1};$("#game-physics").append(a.userData.graphics.element);
var e=createBodyDef("static",b2Vec2_px2m(canvasWidth/2,canvasHeight/CANVASHEIGHT_DIVISION*8));a=c.CreateBody(a);e=c.CreateBody(e);var b=createFixtureDef("polygon",0.25,0.05,undefined,10,0.25,1),g=createFixtureDef("polygon",0.05,0.07,undefined,10,0.25,1),f=createFixtureDef("circle",undefined,undefined,0.01,0,0,0);f.filter.categoryBits=256;a.CreateFixture(b);a.CreateFixture(g);e.CreateFixture(f);b=new b2PrismaticJointDef;b.Initialize(e,a,b2Vec2_px2m(canvasWidth/2,canvasHeight/CANVASHEIGHT_DIVISION*
8),new b2Vec2(1,0));b.lowerTranslation=-PointsToMeters(canvasWidth/2-MetersToPoints(SIDEWALL_WIDTH));b.upperTranslation=PointsToMeters(canvasWidth/2-MetersToPoints(SIDEWALL_WIDTH));b.enableLimit=true;b.maxMotorForce=1E10;b.motorSpeed=3.2;b.enableMotor=true;this.mouseLToRJoint=c.CreateJoint(b)}Mouse.prototype.isMouseAlreadyHitChecking=function(){if(this.isMouseAlreadyHit){this.mouseAlreadyHitCount++;if(this.mouseAlreadyHitCount>30){this.mouseAlreadyHitCount=0;this.isMouseAlreadyHit=false}}};
Mouse.prototype.hitAnyObj=function(c,d){var a=this.mouseLToRJoint.GetMotorSpeed();if(c.type=="sideWall"&&d.type=="mouse"||c.type=="mouse"&&d.type=="sideWall")a=this.mouseLToRJoint.GetMotorSpeed()>0?-3.5:3.5;if((c.type=="coin"&&d.type=="mouse"||c.type=="mouse"&&d.type=="coin")&&!this.isMouseAlreadyHit){a=this.mouseLToRJoint.GetMotorSpeed()>0?-3.5:3.5;this.isMouseAlreadyHit=true}this.mouseLToRJoint.SetMotorSpeed(a)};
function Windmills(d,f){this.b2joint=[];var g=function(h,i,e){var b=createBodyDef("dynamic",b2Vec2_px2m(h,i),Math.PI*0.25);b.angularDamping=0.1;b.userData.graphics={isReady:f.isReady[Enum.Sprites.kSpritesWindmillLarge],image:f.image[Enum.Sprites.kSpritesWindmillLarge],element:$("<div class='game-physics-element'><img src='"+f.image[Enum.Sprites.kSpritesWindmillLarge].src+"'></div>"),xPos:h,yPos:i,angle:Math.PI*0.25,alpha:1};if(e==0){b.userData.graphics.image=f.image[Enum.Sprites.kSpritesWindmillTop];
b.userData.graphics.element=$("<div class='game-physics-element'><img src='"+f.image[Enum.Sprites.kSpritesWindmillTop].src+"'></div>")}if(e==3||e==4){b.userData.graphics.image=f.image[Enum.Sprites.kSpritesWindmillSmall];b.userData.graphics.element=$("<div class='game-physics-element'><img src='"+f.image[Enum.Sprites.kSpritesWindmillSmall].src+"'></div>")}$("#game-physics").append(b.userData.graphics.element);if(e==1||e==2)b.angularDamping=1;b.userData.type="windmill";b=d.CreateBody(b);var c,a;if(e==
3||e==4){c=createFixtureDef("polygon",0.35,0.03,undefined,0.2,0.45,0.1);a=createFixtureDef("polygon",0.03,0.35,undefined,0.2,0.45,0.1)}else{c=createFixtureDef("polygon",0.43,0.03,undefined,0.2,0.45,0.1);a=createFixtureDef("polygon",0.03,0.43,undefined,0.2,0.45,0.1)}c.filter.categoryBits=16;c.filter.maskBits=16;a.filter.categoryBits=16;a.filter.maskBits=16;b.CreateFixture(c);b.CreateFixture(a);c=createBodyDef("static",b2Vec2_px2m(h,i));c.categoryBits=16;c.maskBits=16;c=d.CreateBody(c);a=createFixtureDef("circle",
undefined,undefined,0.03,5,0,0.3);c.CreateFixture(a);a=new b2RevoluteJointDef;a.Initialize(b,c,b2Vec2_px2m(h,i));a.maxMotorTorque=0.2;switch(e){case 0:a.motorSpeed=1.5;break;case 1:a.motorSpeed=-1;break;case 2:a.motorSpeed=1;break;case 3:a.motorSpeed=-1.5;break;case 4:a.motorSpeed=1.5}a.enableMotor=true;if(e==1||e==2)a.enableMotor=false;return windmillJoint=d.CreateJoint(a)};this.b2joint.push(g(canvasWidth/2,canvasHeight/CANVASHEIGHT_DIVISION*5,0));this.b2joint.push(g((xPosOfSlots[0]+xPosOfSlots[1])/
2,canvasHeight/CANVASHEIGHT_DIVISION*10,1));this.b2joint.push(g((xPosOfSlots[7]+xPosOfSlots[8])/2,canvasHeight/CANVASHEIGHT_DIVISION*10,2));this.b2joint.push(g(xPosOfSlots[3],canvasHeight/CANVASHEIGHT_DIVISION*13,3));this.b2joint.push(g(xPosOfSlots[5],canvasHeight/CANVASHEIGHT_DIVISION*13,4));$("#windmill-indicator-top-images").css({left:xPosOfSlots[4]-$(".indicator").width()/2,top:canvasHeight/CANVASHEIGHT_DIVISION*11-$(".indicator").height()/2,position:"absolute"});$("#windmill-indicator-top-images .rotate-clockwise").show();
$("#windmill-indicator-top-images .rotate-anti-clockwise").hide();$("#windmill-indicator-left-images").css({left:xPosOfSlots[3]-$(".indicator").width()/2,top:canvasHeight/CANVASHEIGHT_DIVISION*11-$(".indicator").height()/2,position:"absolute"});$("#windmill-indicator-left-images .rotate-clockwise").hide();$("#windmill-indicator-left-images .rotate-anti-clockwise").show();$("#windmill-indicator-right-images").css({left:xPosOfSlots[5]-$(".indicator").width()/2,top:canvasHeight/CANVASHEIGHT_DIVISION*
11-$(".indicator").height()/2,position:"absolute"});$("#windmill-indicator-right-images .rotate-clockwise").show();$("#windmill-indicator-right-images .rotate-anti-clockwise").hide()}
Windmills.prototype.revereDirection=function(d){if(this.b2joint[d].GetMotorSpeed()==1.5){this.b2joint[d].SetMotorSpeed(-1.5);if(d==3){$("#windmill-indicator-left-images .rotate-clockwise").hide();$("#windmill-indicator-left-images .rotate-anti-clockwise").show()}else if(d==0){$("#windmill-indicator-top-images .rotate-clockwise").hide();$("#windmill-indicator-top-images .rotate-anti-clockwise").show()}else{$("#windmill-indicator-right-images .rotate-clockwise").hide();$("#windmill-indicator-right-images .rotate-anti-clockwise").show()}}else{this.b2joint[d].SetMotorSpeed(1.5);
if(d==3){$("#windmill-indicator-left-images .rotate-clockwise").show();$("#windmill-indicator-left-images .rotate-anti-clockwise").hide()}else if(d==0){$("#windmill-indicator-top-images .rotate-clockwise").show();$("#windmill-indicator-top-images .rotate-anti-clockwise").hide()}else{$("#windmill-indicator-right-images .rotate-clockwise").show();$("#windmill-indicator-right-images .rotate-anti-clockwise").hide()}}};
Windmills.prototype.resetWindmills=function(){if(this.b2joint[0].GetMotorSpeed()==-1.5){this.b2joint[0].SetMotorSpeed(1.5);$("#windmill-indicator-top-images .rotate-clockwise").show();$("#windmill-indicator-top-images .rotate-anti-clockwise").hide()}if(this.b2joint[3].GetMotorSpeed()==1.5){this.b2joint[3].SetMotorSpeed(-1.5);$("#windmill-indicator-left-images .rotate-clockwise").hide();$("#windmill-indicator-left-images .rotate-anti-clockwise").show()}if(this.b2joint[4].GetMotorSpeed()==-1.5){this.b2joint[4].SetMotorSpeed(1.5);
$("#windmill-indicator-right-images .rotate-clockwise").show();$("#windmill-indicator-right-images .rotate-anti-clockwise").hide()}};
function Slides(b,f){this.b2joint=[];var g=function(c,a,e,h){var d=createBodyDef("dynamic",b2Vec2_px2m(c,a),e);d.angularDamping=0.5;d.userData.type="slide";d.userData.graphics={isReady:f.isReady[Enum.Sprites.kSpritesSlide],image:f.image[Enum.Sprites.kSpritesSlide],element:$("<div class='game-physics-element'><img src='"+f.image[Enum.Sprites.kSpritesSlide].src+"'></div>"),xPos:c,yPos:a,angle:e,alpha:1};$("#game-physics").append(d.userData.graphics.element);e=b.CreateBody(d);c=createBodyDef("static",
b2Vec2_px2m(c,a));c=b.CreateBody(c);a=createFixtureDef("polygon",0.45,0.03,undefined,0.5,0,0.9);d=createFixtureDef("circle",undefined,undefined,0.03,5,0,0.3);e.CreateFixture(a);c.CreateFixture(d);a=new b2RevoluteJointDef;a.Initialize(e,c,e.GetWorldCenter());a.lowerAngle=0;a.upperAngle=0;a.enableLimit=true;a.maxMotorTorque=1E10;a.motorSpeed=1.5;a.enableMotor=false;if(h==0){$("#slide-indicator-left-images").css({left:(xPosOfSlots[1]+xPosOfSlots[2])/2-$(".indicator").width()/2,top:canvasHeight/CANVASHEIGHT_DIVISION*
4-$(".indicator").height()/2,position:"absolute"});$("#slide-indicator-left-images .left-down").hide();$("#slide-indicator-left-images .left-up").show()}else{$("#slide-indicator-right-images").css({left:(xPosOfSlots[6]+xPosOfSlots[7])/2-$(".indicator").width()/2,top:canvasHeight/CANVASHEIGHT_DIVISION*4-$(".indicator").height()/2,position:"absolute"});$("#slide-indicator-right-images .left-up").hide();$("#slide-indicator-right-images .left-down").show()}return b.CreateJoint(a)};this.b2joint.push(g((xPosOfSlots[1]+
xPosOfSlots[2])/2,canvasHeight/CANVASHEIGHT_DIVISION*6,0.25*Math.PI,0));this.b2joint.push(g((xPosOfSlots[6]+xPosOfSlots[7])/2,canvasHeight/CANVASHEIGHT_DIVISION*6,0.75*Math.PI,1))}
Slides.prototype.changeDirection=function(b){if(this.b2joint[b].GetJointAngle()<=0){this.b2joint[b].SetMotorSpeed(2);this.b2joint[b].SetLimits(0.5*Math.PI,0.5*Math.PI);if(b==0){$("#slide-indicator-left-images .left-up").hide();$("#slide-indicator-left-images .left-down").show()}else{$("#slide-indicator-right-images .left-down").hide();$("#slide-indicator-right-images .left-up").show()}}if(this.b2joint[b].GetJointAngle()>=0.5*Math.PI){this.b2joint[b].SetMotorSpeed(-2);this.b2joint[b].SetLimits(0,0);
if(b==0){$("#slide-indicator-left-images .left-down").hide();$("#slide-indicator-left-images .left-up").show()}else{$("#slide-indicator-right-images .left-up").hide();$("#slide-indicator-right-images .left-down").show()}}};
Slides.prototype.resetSlides=function(){if(this.b2joint[0].GetJointAngle()>=0.5*Math.PI){this.b2joint[0].SetMotorSpeed(-2);this.b2joint[0].SetLimits(0,0);$("#slide-indicator-left-images .left-down").hide();$("#slide-indicator-left-images .left-up").show()}if(this.b2joint[1].GetJointAngle()>=0.5*Math.PI){this.b2joint[1].SetMotorSpeed(-2);this.b2joint[1].SetLimits(0,0);$("#slide-indicator-right-images .left-up").hide();$("#slide-indicator-right-images .left-down").show()}};
function Nails(b){this.b2body=[];var a=function(e,d,c){var f=createBodyDef("static",b2Vec2_px2m(e,d));f.userData.type="nail";f.userData.sensorId=c;f.userData.nailLv=1;f.userData.isSensorHitAlready=false;c=$("#nail").clone().removeAttr("id").attr("class","nail-copy").appendTo("#nail-container");c=new MovieClip(c,"images/pins.png",13,13,2,3);var g=$("#fever-nail").clone().removeAttr("id").attr("class","fever-nail-copy").appendTo("#nail-container");g=new MovieClip(g,"images/pins_fever.png",13,13,1,3);
c.stopAt(1);c.targetElement.css({left:e-c.targetElement.width()/2+"px",top:d-c.targetElement.height()/2+"px"});g.targetElement.css({left:e-g.targetElement.width()/2+"px",top:d-g.targetElement.height()/2+"px"});f.userData.graphics={nailMC:c,feverNailMC:g,xPos:e,yPos:d,angle:0,alpha:1};e=b.CreateBody(f);d=createFixtureDef("circle",undefined,undefined,PointsToMeters(NAIL_R_PX),0.1,0.65,0.4);e.CreateFixture(d);return e};this.b2body.push(a(xPosOfSlots[1],canvasHeight/CANVASHEIGHT_DIVISION*4,0));this.b2body.push(a(xPosOfSlots[2],
canvasHeight/CANVASHEIGHT_DIVISION*4,1));this.b2body.push(a(xPosOfSlots[3],canvasHeight/CANVASHEIGHT_DIVISION*4,2));this.b2body.push(a(xPosOfSlots[5],canvasHeight/CANVASHEIGHT_DIVISION*4,3));this.b2body.push(a(xPosOfSlots[6],canvasHeight/CANVASHEIGHT_DIVISION*4,4));this.b2body.push(a(xPosOfSlots[7],canvasHeight/CANVASHEIGHT_DIVISION*4,5));this.b2body.push(a(xPosOfSlots[3],canvasHeight/CANVASHEIGHT_DIVISION*7,6));this.b2body.push(a(xPosOfSlots[4],canvasHeight/CANVASHEIGHT_DIVISION*7,7));this.b2body.push(a(xPosOfSlots[5],
canvasHeight/CANVASHEIGHT_DIVISION*7,8));this.b2body.push(a(xPosOfSlots[2],canvasHeight/CANVASHEIGHT_DIVISION*9,9));this.b2body.push(a(xPosOfSlots[3],canvasHeight/CANVASHEIGHT_DIVISION*9,10));this.b2body.push(a(xPosOfSlots[4],canvasHeight/CANVASHEIGHT_DIVISION*9,11));this.b2body.push(a(xPosOfSlots[5],canvasHeight/CANVASHEIGHT_DIVISION*9,12));this.b2body.push(a(xPosOfSlots[6],canvasHeight/CANVASHEIGHT_DIVISION*9,13));this.b2body.push(a((xPosOfSlots[2]+xPosOfSlots[3])/2,canvasHeight/CANVASHEIGHT_DIVISION*
11,14));this.b2body.push(a((xPosOfSlots[3]+xPosOfSlots[4])/2,canvasHeight/CANVASHEIGHT_DIVISION*11,15));this.b2body.push(a((xPosOfSlots[4]+xPosOfSlots[5])/2,canvasHeight/CANVASHEIGHT_DIVISION*11,16));this.b2body.push(a((xPosOfSlots[5]+xPosOfSlots[6])/2,canvasHeight/CANVASHEIGHT_DIVISION*11,17));this.b2body.push(a((xPosOfSlots[1]+xPosOfSlots[2])/2,canvasHeight/CANVASHEIGHT_DIVISION*12,18));this.b2body.push(a((xPosOfSlots[6]+xPosOfSlots[7])/2,canvasHeight/CANVASHEIGHT_DIVISION*12,19));this.b2body.push(a((xPosOfSlots[0]+
xPosOfSlots[1])/2,canvasHeight/CANVASHEIGHT_DIVISION*13,20));this.b2body.push(a((xPosOfSlots[7]+xPosOfSlots[8])/2,canvasHeight/CANVASHEIGHT_DIVISION*13,21));this.b2body.push(a(xPosOfSlots[2],canvasHeight/CANVASHEIGHT_DIVISION*14,22));this.b2body.push(a(xPosOfSlots[4],canvasHeight/CANVASHEIGHT_DIVISION*14,23));this.b2body.push(a(xPosOfSlots[6],canvasHeight/CANVASHEIGHT_DIVISION*14,24));this.b2body.push(a(xPosOfSlots[1],canvasHeight/CANVASHEIGHT_DIVISION*15,25));this.b2body.push(a(xPosOfSlots[3],canvasHeight/
CANVASHEIGHT_DIVISION*15,26));this.b2body.push(a(xPosOfSlots[5],canvasHeight/CANVASHEIGHT_DIVISION*15,27));this.b2body.push(a(xPosOfSlots[7],canvasHeight/CANVASHEIGHT_DIVISION*15,28));this.nailLvUpCounter=30;this.nailLvUpCounterTimer=undefined;this.currentNailLv=1;this.nailIsHitAlreadyCount=0;this.pinLvProgressBarFullDiv=$("#pin-lv-progress-bar-full");this.pinLvProgressBarFullDivWidth=$("#pin-lv-progress-bar-full").width()}
Nails.prototype.sparklingNails=function(b){Tween.get(b.graphics,{loop:false,css:false}).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:0.1},50).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:1},100).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:0.1},50).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:1},100).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:0.1},50).to({xPos:b.graphics.xPos,yPos:b.graphics.yPos,alpha:1},100)};
Nails.prototype.levelUpNails=function(b,a,e){SoundManagerHelper.playSound("pinLvUp");for(var d=0;d<NAIL_AMOUNT;d++){var c=this.b2body[d].GetUserData();c.nailLv<NAIL_MAX_LV&&c.nailLv++;if(a)c.nailLv=e;c.graphics.nailMC.stopAt(c.nailLv);this.sparklingNails(c);c.isSensorHitAlready=c.nailLv==NAIL_MAX_LV?true:false;if(c.nailLv>this.currentNailLv)this.currentNailLv=c.nailLv}if(this.currentNailLv==NAIL_MAX_LV){this.nailLvUpCounter=gameVar.machineParameters.feverModeCountdownTime();this.setNailLvUpCount(this.nailLvUpCounter);
$("#pin-lv-progress-bar-full").css("background","url(images/pin_fever_full.png)");$("#pin-lv-progress-bar-empty").css("background","url(images/pin_fever_empty.png)");$("#game-container").css("background","url(images/bg"+NAIL_MAX_LV+".png)");$("#fever-tree-light-container").show();$("#fever-tree-container").show();$("#fever-tree-light-container")[0].style.opacity=1;Tween.get($("#fever-tree-light-container")[0].style,{loop:true,css:true,override:true}).to({opacity:1},200).to({opacity:0.3},200).to({opacity:1},
200)}else{if(this.currentNailLv==2){this.nailLvUpCounter=gameVar.machineParameters.multiplierOnePointTwoCountdownTime();gameVar.setEarnMultiplier(1.2)}if(this.currentNailLv==3){this.nailLvUpCounter=gameVar.machineParameters.multiplierOnePointFiveCountdownTime();gameVar.setEarnMultiplier(1.5)}this.setNailLvUpCount(this.nailLvUpCounter);$("#game-container").css("background","url(images/bg"+this.currentNailLv+".png)")}if(this.currentNailLv==NAIL_MAX_LV){gameVar.getFeverModeCoins();b.changeSlotsFever()}this.nailIsHitAlreadyCount=
0};
Nails.prototype.levelDownNails=function(b,a){SoundManagerHelper.playSound("pinLvDown");gameVar.setEarnMultiplier(1);$("#game-container").css("background","url(images/bg1.png)");$("#fever-tree-light-container").hide();$("#fever-tree-container").hide();Tween.removeTweens($("#fever-tree-light-container")[0].style);for(var e=0;e<NAIL_AMOUNT;e++){var d=this.b2body[e].GetUserData();d.nailLv=1;d.graphics.nailMC.stopAt(1);this.sparklingNails(d);d.isSensorHitAlready=false;d.graphics.feverNailMC.stopLoop();d.graphics.feverNailMC.targetElement.hide();
d.graphics.nailMC.targetElement.show()}if(this.currentNailLv==NAIL_MAX_LV){b.changeSlotsNormal();b.restoreBackUpStatus(a);$("#indicators-container").show()}this.setNailLvUpCount(0);this.currentNailLv=1;this.nailIsHitAlreadyCount=0};Nails.prototype.levelDownNailsChecking=function(b,a){if(this.nailLvUpCounterTimer==undefined&&gameVar.isFeverMode&&a.coinsCountInMachine==0||this.nailLvUpCounterTimer==undefined&&!gameVar.isFeverMode&&this.currentNailLv>1)this.levelDownNails(b,a)};
Nails.prototype.hitByCoin=function(b,a,e,d){b=b.GetUserData();a=a.GetUserData();var c=5;if(Math.floor(Math.random()*2)>0)c=9;a.graphics.chickEmoMC.isPaused||a.graphics.chickEmoMC.stopAtForTimeAndBackToCurrent(c,5);if(!b.isSensorHitAlready){this.nailIsHitAlreadyCount++;b.isSensorHitAlready=true;a=b.nailLv+1;if(a>NAIL_MAX_LV)a=NAIL_MAX_LV;b.graphics.nailMC.stopAt(a);if(!gameVar.isFeverMode&&this.nailIsHitAlreadyCount==NAIL_AMOUNT&&a<=NAIL_MAX_LV){this.levelUpNails(e,false,0);a!=NAIL_MAX_LV&&d.triggerSlotMachineCount<
MAX_TRIGGER_SLOT_MACHINE_COUNT&&d.triggerOnce()}}};
Nails.prototype.startNailLvUpCountDown=function(){var b=this;if(this.nailLvUpCounter>0){gameVar.timeStep!=0&&this.nailLvUpCounter--;var a=0;if(this.currentNailLv==2)a=gameVar.machineParameters.multiplierOnePointTwoCountdownTime();if(this.currentNailLv==3)a=gameVar.machineParameters.multiplierOnePointFiveCountdownTime();if(this.currentNailLv==NAIL_MAX_LV)a=gameVar.machineParameters.feverModeCountdownTime();this.pinLvProgressBarFullDiv.css("width",(0.075+0.41*(this.nailLvUpCounter/a))*this.pinLvProgressBarFullDivWidth+
"px");if(this.nailLvUpCounter>0)this.nailLvUpCounterTimer=setTimeout(function(){b.startNailLvUpCountDown()},1E3);else{clearTimeout(this.nailLvUpCounterTimer);this.nailLvUpCounterTimer=undefined}}};
Nails.prototype.setNailLvUpCount=function(b){if(this.nailLvUpCounterTimer!=undefined){clearTimeout(this.nailLvUpCounterTimer);this.nailLvUpCounterTimer=undefined}this.nailLvUpCounter=b;b=0;if(this.currentNailLv==2)b=gameVar.machineParameters.multiplierOnePointTwoCountdownTime();if(this.currentNailLv==3)b=gameVar.machineParameters.multiplierOnePointFiveCountdownTime();if(this.currentNailLv==NAIL_MAX_LV)b=gameVar.machineParameters.feverModeCountdownTime();if(this.nailLvUpCounter>b)this.nailLvUpCounter=
b;this.startNailLvUpCountDown()};
function Triggers(c){this.b2body=[];this.feverTrigger1MC=new MovieClip($("#fever-trigger-1-coin"),"images/trigger-animation.png",38,14,4,1);this.feverTrigger3MC=new MovieClip($("#fever-trigger-3-coin"),"images/trigger-animation.png",38,14,4,1);var d=function(a,g,e){a=createBodyDef("static",b2Vec2_px2m(a,g));a.userData.type="trigger";a.userData.sensorId=e;a.userData.isSensorHitAlready=false;e=c.CreateBody(a);a=createFixtureDef("polygon",0.2,0.0010,undefined,0,0,0);a.isSensor=true;e.CreateFixture(a);
return e};this.b2body.push(d((xPosOfSlots[1]+xPosOfSlots[2])/2,canvasHeight/CANVASHEIGHT_DIVISION*4,0));this.b2body.push(d((xPosOfSlots[6]+xPosOfSlots[7])/2,canvasHeight/CANVASHEIGHT_DIVISION*4,1));this.b2body.push(d(xPosOfSlots[3],canvasHeight/CANVASHEIGHT_DIVISION*11,2));this.b2body.push(d(xPosOfSlots[4],canvasHeight/CANVASHEIGHT_DIVISION*11,3));this.b2body.push(d(xPosOfSlots[5],canvasHeight/CANVASHEIGHT_DIVISION*11,4));this._genOneCoinTriggerNo=2;this._genThreeCoinTriggerNo=4}
Triggers.prototype.resetTriggerSwitch=function(c){this.b2body[c].GetUserData().isSensorHitAlready=false};
Triggers.prototype.hitByCoin=function(c,d,a,g,e,f,i,h){var b=c.GetUserData();d.GetUserData();if(!b.isSensorHitAlready){b.isSensorHitAlready=true;if(gameVar.isFeverMode){if(g.nailLvUpCounterTimer!=undefined){if(b.sensorId==this._genOneCoinTriggerNo&&a.coinsCountInMachine<gameVar.machineParameters.coinsInMachineLimit()){SoundManagerHelper.playSound("passFeverTrigger");a.createAt(0,0,true);h.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoHitFeverTrigger,"isFirstTimeHitFeverTrigger")}if(b.sensorId==
this._genThreeCoinTriggerNo&&a.coinsCountInMachine<gameVar.machineParameters.coinsInMachineLimit()){SoundManagerHelper.playSound("passFeverTrigger");for(f=0;f<3;f++)a.createAt(0,0,true);h.requestToShowTutoWithNoAndCheckKey(Enum.TutoNo.kTutoHitFeverTrigger,"isFirstTimeHitFeverTrigger")}}}else{if(b.sensorId==0||b.sensorId==1){a=0;if(b.sensorId==1)a=1;e.changeDirection(a)}if(b.sensorId==2||b.sensorId==3||b.sensorId==4){a=3;if(b.sensorId==3)a=0;if(b.sensorId==4)a=4;f.revereDirection(a)}}setTimeout(function(){i.resetTriggerSwitch(b.sensorId)},
1800)}};
Triggers.prototype.updateRandomGenCoinTriggerNo=function(c){if(gameVar.isFeverMode){if(gameVar.isFeverMode&&c.nailLvUpCounterTimer!=undefined)if(gameVar.randomGenCoinTriggerNoTimeLeft==0){this._genOneCoinTriggerNo=c=Math.floor(Math.random()*TRIGGER_AMOUNT);do c=Math.floor(Math.random()*TRIGGER_AMOUNT);while(c==this._genOneCoinTriggerNo);this._genThreeCoinTriggerNo=c;this.feverTrigger1MC.targetElement.css({left:MetersToPoints(this.b2body[this._genOneCoinTriggerNo].GetPosition().x)-this.feverTrigger1MC.mcWidth/2+
"px",top:MetersToPoints(this.b2body[this._genOneCoinTriggerNo].GetPosition().y)-this.feverTrigger1MC.mcHeight/2+"px"});if(!this.feverTrigger1MC.isLooping){this.feverTrigger1MC.targetElement.show();this.feverTrigger1MC.playLoop(0,undefined,5)}this.feverTrigger3MC.targetElement.css({left:MetersToPoints(this.b2body[this._genThreeCoinTriggerNo].GetPosition().x)-this.feverTrigger3MC.mcWidth/2+"px",top:MetersToPoints(this.b2body[this._genThreeCoinTriggerNo].GetPosition().y)-this.feverTrigger3MC.mcHeight/
2+"px"});if(!this.feverTrigger3MC.isLooping){this.feverTrigger3MC.targetElement.show();this.feverTrigger3MC.playLoop(0,undefined,5)}gameVar.randomGenCoinTriggerNoTimeLeft=RANDOM_GEN_CON_TRIGGER_NO_TIME}}else if(this.feverTrigger1MC.isLooping&&this.feverTrigger3MC.isLooping){this.feverTrigger1MC.targetElement.hide();this.feverTrigger1MC.stopLoop();this.feverTrigger3MC.targetElement.hide();this.feverTrigger3MC.stopLoop()}};
function SlotMachine(a,d){this.triggerSlotMachineCount=0;this.getNails=function(){return a};this.getSlots=function(){return d}}
SlotMachine.prototype.trigger=function(a,d,b){if(this.triggerSlotMachineCount>0&&b.tutoQueue.length==0&&!b.isShowingTuto){b=Math.floor(Math.random()*1E3);var e=Math.floor(Math.random()*1E3);a=this.triggerSlotMachineToGetMsgNoWithRandNo(Math.floor(Math.random()*1E3),a);e=this.getItemSeriesNo(e);b=this.getItemClassNo(b,false);console.log("Msg: "+a+" seriesNo: "+e+" classNo: "+b);d.requestToShowSlotMachineWithMessage(a,e,b);this.triggerSlotMachineCount-=1}else if(b.tutoQueue.length>0&&!b.isShowingTuto&&
!d.isShowingAlert){b.isShowingTuto=true;b.showTuto()}};SlotMachine.prototype.triggerOnce=function(){if(!gameVar.isShowingLeaderboard||!gameVar.isTimeChallengeModeEnd)this.triggerSlotMachineCount+=1};
SlotMachine.prototype.triggerSlotMachineToGetMsgNoWithRandNo=function(a,d){var b=Enum.AlertMessage.kMsgGetNothing,e=0,c=0;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeAddOneCoin)*10;if(a>=e&&a<=c-1)b=Enum.AlertMessage.kMsgGetOneCoin;e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeAddTwoCoin)*10;if(a>=e&&a<=c-1)b=!gameVar.isFeverMode&&d.currentNailLv>1&&d.currentNailLv<NAIL_MAX_LV&&d.nailLvUpCounter>=5&&d.nailLvUpCounter<=30?Enum.AlertMessage.kMsgGet15s:
Enum.AlertMessage.kMsgGetTwoCoins;e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeAddFiveCoin)*10;if(a>=e&&a<=c-1)b=!gameVar.isFeverMode&&d.currentNailLv>1&&d.currentNailLv<NAIL_MAX_LV&&d.nailLvUpCounter>=3&&d.nailLvUpCounter<=20?Enum.AlertMessage.kMsgGet30s:Enum.AlertMessage.kMsgGetFiveCoins;e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeMultiplierOnePtTwo)*10;if(a>=e&&a<=c-1)b=!gameVar.isFeverMode&&gameVar.earnMultiplier==1?Enum.AlertMessage.kMsgGetMultiplierOnePtTwo:
Enum.AlertMessage.kMsgGetOneCoin;e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeMultiplierOnePtFive)*10;if(a>=e&&a<=c-1)b=!gameVar.isFeverMode&&gameVar.earnMultiplier<=1.2?Enum.AlertMessage.kMsgGetMultiplierOnePtFive:Enum.AlertMessage.kMsgGetOneCoin;e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeFeverMode)*10;if(a>=e&&a<=c-1)b=!gameVar.isFeverMode&&gameVar.earnMultiplier<=1.5?Enum.AlertMessage.kMsgGetFeverMode:Enum.AlertMessage.kMsgGetOneItem;
e=c;c+=gameVar.machineParameters.prizeProbsAtPrize(Enum.SlotMachinePrize.kPrizeGetItems)*10;if(a>=e&&a<=c-1)b=Enum.AlertMessage.kMsgGetOneItem;if(b==Enum.AlertMessage.kMsgGetOneItem)b=Enum.AlertMessage.kMsgGetOneCoin;return b};SlotMachine.prototype.getItemSeriesNo=function(a){for(var d=0,b=0,e=0,c=0;c<MAX_ITEM_SERIES;c++){e+=gameVar.machineParameters.itemSeriesProbsAtItemSeriesNo(c)*10;if(a>=b&&a<=e-1)d=c;b=e}return d};
SlotMachine.prototype.getItemClassNo=function(a,d){for(var b=0,e=0,c=0,f=c=e=0;f<MAX_ITEM_CLASS;f++){c+=gameVar.machineParameters.itemClassProbsAtItemClassNo(f,d)*10;if(a>=e&&a<=c-1)b=f;e=c}return b};
SlotMachine.prototype.getSlotMachinePrize=function(a,d,b){console.log("LOGICAL=> Msg: "+a+" seriesNo: "+d+" classNo: "+b);d=this.getNails();b=this.getSlots();if(a==Enum.AlertMessage.kMsgGetOneCoin){gameVar.remainCoins+=1;GameSave.saveRemainCoins(gameVar.remainCoins);gameVar.updateChallengeModeTotalEarnCoins(1)}if(a==Enum.AlertMessage.kMsgGetTwoCoins){gameVar.remainCoins+=2;GameSave.saveRemainCoins(gameVar.remainCoins);gameVar.updateChallengeModeTotalEarnCoins(2)}if(a==Enum.AlertMessage.kMsgGetFiveCoins){gameVar.remainCoins+=
5;GameSave.saveRemainCoins(gameVar.remainCoins);gameVar.updateChallengeModeTotalEarnCoins(5)}a==Enum.AlertMessage.kMsgGet15s&&d.setNailLvUpCount(d.nailLvUpCounter+15);a==Enum.AlertMessage.kMsgGet30s&&d.setNailLvUpCount(d.nailLvUpCounter+30);a==Enum.AlertMessage.kMsgGetMultiplierOnePtTwo&&d.levelUpNails(b,true,2);a==Enum.AlertMessage.kMsgGetMultiplierOnePtFive&&d.levelUpNails(b,true,3);a==Enum.AlertMessage.kMsgGetFeverMode&&d.levelUpNails(b,true,NAIL_MAX_LV)};
function Timeline(){this.globalCount=1;this.targetList=[];this.nextActionTimes=[];this.maxGlobalCount=99999}Timeline.prototype.goForwardOneFrame=function(){this.globalCount++;if(this.globalCount>this.maxGlobalCount)this.globalCount=1;for(var a=this.targetList.length;a--;){this.nextActionTimes[a]==this.globalCount&&this.targetList[a].action();if(this.nextActionTimes[a]==-1){this.targetList.splice(a,1);this.nextActionTimes.splice(a,1)}}};
Timeline.prototype.removeFromTimeline=function(a){for(var c=this.targetList.length;c--;)if(this.targetList[c]==a)this.nextActionTimes[c]=-1};Timeline.prototype.addToTimeline=function(a,c){for(var d=true,e=0,b=this.targetList.length;b--;)if(this.targetList[b]==a){d=false;e=b}b=this.globalCount+c;if(b>this.maxGlobalCount)b-=this.maxGlobalCount;if(d){this.targetList.push(a);this.nextActionTimes.push(b)}else this.nextActionTimes[e]=b};
function ChickenRainWorld(a){this.loader=new SpritesLoader;this.coins=new Coins(a,this.loader);this.slots=new Slots(a);this.boundingBox=new BoundingBox(a);this.launchTunnel=new LaunchTunnel(a,this.loader);this.mouse=new Mouse(a,this.loader);this.windmills=new Windmills(a,this.loader);this.slides=new Slides(a,this.loader);this.nails=new Nails(a,this.loader);this.triggers=new Triggers(a);this.tutoCenter=new TutoCenter;this.slotMachine=new SlotMachine(this.nails,this.slots);this.alertCenter=new AlertCenter(this.slotMachine);
this.spotLights=new SpotLights}
ChickenRainWorld.prototype.startChallengeMode=function(){if(!this.alertCenter.isShowingAlert&&!gameVar.isInTimeChallengeMode&&!gameVar.isFeverMode){this.resetcrWorld(true);gameVar.isInTimeChallengeMode=true;gameVar.remainCoins=15;GameSave.saveRemainCoins(gameVar.remainCoins);gameVar.setChallengeTimeAndStartCount(180)}$("#dim-screen").show();$("#challeng-mode-countdown-container").show();$("#challeng-mode-countdown")[0].style.top="80px";Tween.get($("#challeng-mode-countdown")[0].style,{loop:false,
css:true,override:true}).to({top:165},150).wait(800).to({top:230},50).call(function(){$("#challeng-mode-countdown").attr("src","images/digit_2.png")}).to({top:80},50).to({top:165},150).wait(800).to({top:230},10).call(function(){$("#challeng-mode-countdown").attr("src","images/digit_1.png")}).to({top:80},50).to({top:165},150).wait(800).call(function(){$("#dim-screen").hide();$("#challeng-mode-countdown-container").hide();$("#challeng-mode-countdown").attr("src","images/digit_3.png");gameVar.pauseGame()})};
ChickenRainWorld.prototype.resetcrWorld=function(a){this.coins.clearAllCoins(this.boundingBox,a);this.slots.spotLights.hideAll(this.slots);this.slots.makeBtmSensorTransparent(false);this.slides.resetSlides();this.windmills.resetWindmills();this.nails.levelDownNails(this.slots,this.coins)};
$(function(){var b=new b2World(new b2Vec2(0,19.8),true),d=new b2ContactListener;b.SetContactListener(d);mcLoader=new MovieClipLoader;var a=new ChickenRainWorld(b);gameVar=new GameVar(a);window.setInterval(function(){update(b,d,a)},1E3/60);timeline=new Timeline;$("#addCoinButton").click(function(){!gameVar.isTimeChallengeModeEnd&&gameVar.timeStep!=0&&a.coins.addNewCoin(a.launchTunnel);return false});$("#earnCoinButton").click(function(){!gameVar.isTimeChallengeModeEnd&&gameVar.timeStep!=0&&a.coins.earnCoin(a.slots);
return false});$("#nailLvUpButton").click(function(){a.nails.levelUpNails(a.slots,false,0);return false});$("#feverModeButton").click(function(){a.nails.levelUpNails(a.slots,true,NAIL_MAX_LV);return false});$("#triggerSlotMachineButton").click(function(){a.slotMachine.triggerOnce();return false});$("#freeModeButton").click(function(){GameSave.loadIsBGMOn()&&SoundManagerHelper.unmuteBGM();SoundManagerHelper.playSound("clickBtn");$("#start-menu-container").hide();$("#pauseButton").show();gameVar.pauseGame();
return false});$("#challengModeButton").click(function(){GameSave.loadIsBGMOn()&&SoundManagerHelper.unmuteBGM();$("#start-menu-container").hide();SoundManagerHelper.playSound("clickBtn");$("#dim-screen").show();$("#challenge-mode-menu-container").show();return false});$("#challengModeStartButton").click(function(){$("#challenge-mode-menu-container").hide();$("#dim-screen").hide();SoundManagerHelper.playSound("clickBtn");a.startChallengeMode()});$("#playAgainButton").click(function(){gameVar.finishChallengeMode();
SoundManagerHelper.playSound("clickBtn");a.startChallengeMode()});$("#backToMenuButton").click(function(){SoundManagerHelper.muteBGM();gameVar.finishChallengeMode();SoundManagerHelper.playSound("clickBtn");$("#start-menu-container").show()});$("#pauseButton").click(function(){SoundManagerHelper.muteBGM();SoundManagerHelper.playSound("clickBtn");gameVar.pauseGame();$("#pauseButton").hide();$("#start-menu-container").show()});$("#closeTutoButton").click(function(){a.tutoCenter.finishTuto();SoundManagerHelper.playSound("clickBtn");
return false});$("#bgmButton").click(function(){SoundManagerHelper.playSound("clickBtn");var c=$("#bgmImage").attr("src")==="images/bgm_on.png"?"images/bgm_off.png":"images/bgm_on.png";$("#bgmImage").attr("src",c);if(c=="images/bgm_off.png"){GameSave.saveIsBGMOn(false);SoundManagerHelper.muteBGM()}else{GameSave.saveIsBGMOn(true);SoundManagerHelper.unmuteBGM()}return false});$("#sfxButton").click(function(){SoundManagerHelper.playSound("clickBtn");var c=$("#sfxImage").attr("src")==="images/sfx_on.png"?
"images/sfx_off.png":"images/sfx_on.png";$("#sfxImage").attr("src",c);if(c=="images/sfx_off.png"){GameSave.saveIsSFXOn(false);SoundManagerHelper.muteSFX()}else{GameSave.saveIsSFXOn(true);SoundManagerHelper.unmuteSFX()}return false})});
function update(b,d,a){b.Step(gameVar.timeStep,10,10);b.ClearForces();if(gameVar.timeStep!=0){timeline.goForwardOneFrame();gameVar.autoRegenCoinsChecking();gameVar.reduceRandomGenCoinTriggerNoTime();gameVar.checkCanEndTimeChallengeMode();SpritesHelper.update(b,a.loader,a.slots);a.coins.reduceReloadTime();a.coins.canAddNewCoinsAtFeverModeChecking(a.nails);a.coins.b2BodiesChecking(a.boundingBox);a.coins.canEarnNowChecking(a.slots,a.tutoCenter);a.slots.btmSensorTransparentChecking();a.boundingBox.removeUnusedCoinBodies(a.slots);
a.launchTunnel.motorSpeedChecking();a.mouse.isMouseAlreadyHitChecking();a.nails.levelDownNailsChecking(a.slots,a.coins);a.triggers.updateRandomGenCoinTriggerNo(a.nails);a.slotMachine.trigger(a.nails,a.alertCenter,a.tutoCenter);d.b2ContactsChecking(a)}};
